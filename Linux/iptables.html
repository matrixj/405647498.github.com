
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh" xml:lang="zh">
<head>
<title>iptables防火墙</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="title" content="iptables防火墙"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2012-04-29 日"/>
<meta name="author" content="纪秀峰"/>
<meta name="description" content="iptables防火墙"/>
<meta name="keywords" content=""/>
<style type='text/css'>
       body {
    background-color: #E5E5E5;
	scrollbar-face-color: #DEE3E7;
	scrollbar-highlight-color: #FFFFFF;
	scrollbar-shadow-color: #DEE3E7;
	scrollbar-3dlight-color: #D1D7DC;
	scrollbar-arrow-color:  #006699;
	scrollbar-track-color: #EFEFEF;
	scrollbar-darkshadow-color: #98AAB1;
    /* background-color: #999966;  */
    margin: 0em;
}

h1 {
    font-size: 2.0em;
    margin-top: 1.0em;
    margin-bottom: 0.3em;
}
h2 {
    font-size: 1.5em;
    margin-top: 2.4em;
    margin-bottom: 0.3em;
}
h3 {
    font-size: 1.25em;
    margin-top: 1.25em;
    margin-bottom: 0.3em;
}


div#content {
    font-family: Times, serif;
    border-left: double #333300 3mm;
    border-right: double #333300 3mm;
    letter-spacing: 0.075em;
    line-height: 1.4;
    margin: 0em auto;
    padding: 2em;
    width: 92%;
    height:100%; 
    min-height:600px;           /*firefox do'nt support height:100% ,so*/
 
}
/* #table-of-contents { */
/* 	font-size: 75%; */
/* 	line-height: 1.4em; */
/* 	position: fixed; */
/* 	display: block; */
/* 	left: -20px; */
/* 	top: 5%; */
/* 	width: 250px; */
/* 	min-height:60px; */
/* 	max-height:95%; */
/* 	overflow:hidden; */
/*     white-space:nowrap; */
/* } */

#org-div-home-and-up{
	position: fixed;
	display: block;
	right: 18px;
	top: 5px;
	overflow:auto;
    }
#org-src{
	position: fixed;
	display: block;
	right: 18px;
	top: 20px;
	overflow:hidden;
    }
#htmlized-src{
	position: fixed;
	display: block;
	right: 54px;
	top: 20px;
	overflow:hidden;
    }
#table-of-contents h2 {
	display:none;
}

#logo-text{
	position: fixed;
	display: block;
	right: 16px;
	bottom: 3px;
	overflow:hidden;
}
#logo-img{
    font-size: 60%;
	position: fixed;
	display: block;
    left: 16px;
	top: 3px;
    }
div#tags {
	font-size: 75%;
    text-align:right;
	/* line-height: 1.4em; */
	position: fixed;
	display: block;
	right: 40px;
	top: 20%;
	width: 90px;
	/* min-height:60px; */
	max-height:95%;
	/* overflow:visible; */
    /* white-space:pre-wrap; */
}

.title {
    text-align:center;
	padding-bottom: 7px;
	margin-bottom: 20px;
	border-bottom: 1px solid #222;
}
 a:link,a:active,a:visited { color : #006699; } 
 a:hover		{ text-decoration: underline; color : #DD6900; } 

.todo {color: #990000;}
.done {color: #006666;}
.timestamp-kwd {color: #444;}
.tag {color: #DDD; font-size: 70%; font-weight: 500;}

table {border: none;
       width:90%;
      }
th	{
	background-color: #006699; 
}
td	{
    padding: .1em .7em .1em .3em;
	background-color: Gainsboro
}


code {
font-family: Andale Mono, Courier New, Courier, sans-serif; font-size: 12px; line-height: 14px; color: #0000A0;
	background-color: #FAFAFA; border: #D1D7DC; border-style: solid;
	border-left-width: 1px; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px
}

/* pre { */
/* 	border: 1px solid #555; */
/* 	background: #EEEEEE; */
/* 	font-size: 9pt; */
/* 	padding: 1em; */
/* } */
pre.src {
	border: 1px solid #555;
	background:#0c1021;
    /* background:#263111; */
    color: #f7f8c6;
	font-size: 10pt;
    width:85%;
	padding: 0em;
	margin: 0;
	width: 700px;
	float: none;
	clear: none;
	line-height: 1.333;
	text-align:left;
    
    /* overflow: scroll; */
    max-height:500px;           /*IEXPLORE  don't support max-height*/
    _height:expression(this.scrollHeight > 300 ? "300px" : "auto");
    min-height:50px;
    max-width:700px;
    min-width:700px;
    overflow-x:auto;
    overflow-y:auto;
}
blockquote {
	 border: #D1D7DC;
     border-style: solid;
	border-left-width: 1px;
    border-top-width: 1px;
    border-right-width: 1px;
    border-bottom-width: 1px
    
    color: #444444;
    line-height: 125%;
	border: 1px solid #555;
    background-color: #FAFAFA;    
    width:95%;
	padding: 1em;
	margin: 0;
	float: none;
	clear: none;
	text-align:left;
    font-style:italic;
    
    /* overflow: scroll; */
    max-height:300px;           /*IEXPLORE  don't support max-height*/
    _height:expression(this.scrollHeight > 300 ? "300px" : "auto");
    min-height:20px;
    max-width:700px;
    min-width:700px;
    overflow-x:auto;
    overflow-y:auto;
}

.org-function-name {
    /* font-lock-function-name-face */
    /* color: #0000ff; */
     color: #87cefa;
     font-stretch: normal;
     text-decoration: none;
}

.org-keyword {
    /* font-lock-keyword-face */
    color: #00ffff;
    text-decoration: none;
    /* color: #a020f0; */
}
.org-doc
 { color: #ffa07a;
   text-decoration: none;
 }
p.author{
    font-size:80%;
    color:#556b2f;
    font-style:italic;
    position:fixed;
    left:10px;
    bottom:40px;
}
p.date{
    font-size:80%;
    color:#556b2f;
    font-style:italic;
    position:fixed;
    left:10px;
    bottom:0px;
}
p.creator{
    font-size:80%;
    color:#556b2f;
    font-style:italic;
    position:fixed;
    left:10px;
    bottom:20px;
}

img {
    display:inline;
	border: none;
    float:none;
    clear:none;
    left:10px;
}

.share img {
	opacity: .4;
	-moz-opacity: .4;
	filter: alpha(opacity=40);
}

.share img:hover {
	opacity: 1;
	-moz-opacity: 1;
	filter: alpha(opacity=100);
}

.org-info-search-highlight
{
	background-color:#adefef; /* same color as emacs default */
	color:#000000;
	font-weight:bold;
}

.org-bbdb-company {
    /* bbdb-company */
    font-style: italic;
}
.org-bbdb-field-name {
}
.org-bbdb-field-value {
}
.org-bbdb-name {
    /* bbdb-name */
    text-decoration: underline;
}
.org-bold {
    /* bold */
    font-weight: bold;
}
.org-bold-italic {
    /* bold-italic */
    font-weight: bold;
    font-style: italic;
}
.org-border {
    /* border */
    background-color: #000000;
}
.org-buffer-menu-buffer {
    /* buffer-menu-buffer */
    font-weight: bold;
}
.org-builtin {
    /* font-lock-builtin-face */
    color: #da70d6;
}
.org-button {
    /* button */
    text-decoration: underline;
}
.org-c-nonbreakable-space {
    /* c-nonbreakable-space-face */
    background-color: #ff0000;
    font-weight: bold;
}
.org-calendar-today {
    /* calendar-today */
    text-decoration: underline;
}
.org-comment {
    /* font-lock-comment-face */
    color: #b22222;
}
.org-comment-delimiter {
    /* font-lock-comment-delimiter-face */
    color: #b22222;
}
.org-constant {
    /* font-lock-constant-face */
    color: #5f9ea0;
}
.org-cursor {
    /* cursor */
    background-color: #000000;
}
.org-default {
    /* default */
    color: #000000;
    background-color: #ffffff;
}
.org-diary {
    /* diary */
    color: #ff0000;
}
.org-escape-glyph {
    /* escape-glyph */
    color: #a52a2a;
}
.org-file-name-shadow {
    /* file-name-shadow */
    color: #7f7f7f;
}
.org-fixed-pitch {
}
.org-fringe {
    /* fringe */
    background-color: #f2f2f2;
}
.org-header-line {
    /* header-line */
    color: #333333;
    background-color: #e5e5e5;
}
.org-help-argument-name {
    /* help-argument-name */
    font-style: italic;
}
.org-highlight {
    /* highlight */
    background-color: #b4eeb4;
}
.org-holiday {
    /* holiday */
    background-color: #ffc0cb;
}
.org-info-header-node {
    /* info-header-node */
    color: #a52a2a;
    font-weight: bold;
    font-style: italic;
}
.org-info-header-xref {
    /* info-header-xref */
    color: #0000ff;
    text-decoration: underline;
}
.org-info-menu-header {
    /* info-menu-header */
    font-weight: bold;
}
.org-info-menu-star {
    /* info-menu-star */
    color: #ff0000;
}
.org-info-node {
    /* info-node */
    color: #a52a2a;
    font-weight: bold;
    font-style: italic;
}
.org-info-title-1 {
    /* info-title-1 */
    font-size: 172%;
    font-weight: bold;
}
.org-info-title-2 {
    /* info-title-2 */
    font-size: 144%;
    font-weight: bold;
}
.org-info-title-3 {
    /* info-title-3 */
    font-size: 120%;
    font-weight: bold;
}
.org-info-title-4 {
    /* info-title-4 */
    font-weight: bold;
}
.org-info-xref {
    /* info-xref */
    color: #0000ff;
    text-decoration: underline;
}
.org-isearch {
    /* isearch */
    color: #b0e2ff;
    background-color: #cd00cd;
}
.org-italic {
    /* italic */
    font-style: italic;
}
.org-lazy-highlight {
    /* lazy-highlight */
    background-color: #afeeee;
}
.org-link {
    /* link */
    color: #0000ff;
    text-decoration: underline;
}
.org-link-visited {
    /* link-visited */
    color: #8b008b;
    text-decoration: underline;
}
.org-match {
    /* match */
    background-color: #ffff00;
}
.org-menu {
}
.org-message-cited-text {
    /* message-cited-text */
    color: #ff0000;
}
.org-message-header-cc {
    /* message-header-cc */
    color: #191970;
}
.org-message-header-name {
    /* message-header-name */
    color: #6495ed;
}
.org-message-header-newsgroups {
    /* message-header-newsgroups */
    color: #00008b;
    font-weight: bold;
    font-style: italic;
}
.org-message-header-other {
    /* message-header-other */
    color: #4682b4;
}
.org-message-header-subject {
    /* message-header-subject */
    color: #000080;
    font-weight: bold;
}
.org-message-header-to {
    /* message-header-to */
    color: #191970;
    font-weight: bold;
}
.org-message-header-xheader {
    /* message-header-xheader */
    color: #0000ff;
}
.org-message-mml {
    /* message-mml */
    color: #228b22;
}
.org-message-separator {
    /* message-separator */
    color: #a52a2a;
}
.org-minibuffer-prompt {
    /* minibuffer-prompt */
    color: #0000cd;
}
.org-mm-uu-extract {
    /* mm-uu-extract */
    color: #006400;
    background-color: #ffffe0;
}
.org-mode-line {
    /* mode-line */
    color: #000000;
    background-color: #bfbfbf;
}
.org-mode-line-buffer-id {
    /* mode-line-buffer-id */
    font-weight: bold;
}
.org-mode-line-highlight {
}
.org-mode-line-inactive {
    /* mode-line-inactive */
    color: #333333;
    background-color: #e5e5e5;
}
.org-mouse {
    /* mouse */
    background-color: #000000;
}
.org-negation-char {
}
.org-next-error {
    /* next-error */
    background-color: #eedc82;
}
.org-nobreak-space {
    /* nobreak-space */
    color: #a52a2a;
    text-decoration: underline;
}
.org-org-agenda-date {
    /* org-agenda-date */
    color: #0000ff;
}
.org-org-agenda-date-weekend {
    /* org-agenda-date-weekend */
    color: #0000ff;
    font-weight: bold;
}
.org-org-agenda-restriction-lock {
    /* org-agenda-restriction-lock */
    background-color: #ffff00;
}
.org-org-agenda-structure {
    /* org-agenda-structure */
    color: #0000ff;
}
.org-org-archived {
    /* org-archived */
    color: #7f7f7f;
}
.org-org-code {
    /* org-code */
    color: #7f7f7f;
}
.org-org-column {
    /* org-column */
    background-color: #e5e5e5;
}
.org-org-column-title {
    /* org-column-title */
    background-color: #e5e5e5;
    font-weight: bold;
    text-decoration: underline;
}
.org-org-date {
    /* org-date */
    color: #a020f0;
    text-decoration: underline;
}
.org-org-done {
    /* org-done */
    color: #228b22;
    font-weight: bold;
}
.org-org-drawer {
    /* org-drawer */
    color: #0000ff;
}
.org-org-ellipsis {
    /* org-ellipsis */
    color: #b8860b;
    text-decoration: underline;
}
.org-org-formula {
    /* org-formula */
    color: #b22222;
}
.org-org-headline-done {
    /* org-headline-done */
    color: #bc8f8f;
}
.org-org-hide {
    /* org-hide */
    color: #e5e5e5;
}
.org-org-latex-and-export-specials {
    /* org-latex-and-export-specials */
    color: #8b4513;
}
.org-org-level-1 {
    /* org-level-1 */
    color: #0000ff;
}
.org-org-level-2 {
    /* org-level-2 */
    color: #b8860b;
}
.org-org-level-3 {
    /* org-level-3 */
    color: #a020f0;
}
.org-org-level-4 {
    /* org-level-4 */
    color: #b22222;
}
.org-org-level-5 {
    /* org-level-5 */
    color: #228b22;
}
.org-org-level-6 {
    /* org-level-6 */
    color: #5f9ea0;
}
.org-org-level-7 {
    /* org-level-7 */
    color: #da70d6;
}
.org-org-level-8 {
    /* org-level-8 */
    color: #bc8f8f;
}
.org-org-link {
    /* org-link */
    color: #a020f0;
    text-decoration: underline;
}
.org-org-property-value {
}
.org-org-scheduled-previously {
    /* org-scheduled-previously */
    color: #b22222;
}
.org-org-scheduled-today {
    /* org-scheduled-today */
    color: #006400;
}
.org-org-sexp-date {
    /* org-sexp-date */
    color: #a020f0;
}
.org-org-special-keyword {
    /* org-special-keyword */
    color: #bc8f8f;
}
.org-org-table {
    /* org-table */
    color: #0000ff;
}
.org-org-tag {
    /* org-tag */
    font-weight: bold;
}
.org-org-target {
    /* org-target */
    text-decoration: underline;
}
.org-org-time-grid {
    /* org-time-grid */
    color: #b8860b;
}
.org-org-todo {
    /* org-todo */
    color: #ff0000;
}
.org-org-upcoming-deadline {
    /* org-upcoming-deadline */
    color: #b22222;
}
.org-org-verbatim {
    /* org-verbatim */
    color: #7f7f7f;
    text-decoration: underline;
}
.org-org-warning {
    /* org-warning */
    color: #ff0000;
    font-weight: bold;
}
.org-outline-1 {
    /* outline-1 */
    color: #0000ff;
}
.org-outline-2 {
    /* outline-2 */
    color: #b8860b;
}
.org-outline-3 {
    /* outline-3 */
    color: #a020f0;
}
.org-outline-4 {
    /* outline-4 */
    color: #b22222;
}
.org-outline-5 {
    /* outline-5 */
    color: #228b22;
}
.org-outline-6 {
    /* outline-6 */
    color: #5f9ea0;
}
.org-outline-7 {
    /* outline-7 */
    color: #da70d6;
}
.org-outline-8 {
    /* outline-8 */
    color: #bc8f8f;
}
.org-preprocessor {
    /* font-lock-preprocessor-face */
    color: #da70d6;
}
.org-query-replace {
    /* query-replace */
    color: #b0e2ff;
    background-color: #cd00cd;
}
.org-regexp-grouping-backslash {
    /* font-lock-regexp-grouping-backslash */
    font-weight: bold;
}
.org-regexp-grouping-construct {
    /* font-lock-regexp-grouping-construct */
    font-weight: bold;
}
.org-region {
    /* region */
    background-color: #eedc82;
}
.org-rmail-highlight {
}
.org-scroll-bar {
    /* scroll-bar */
    background-color: #bfbfbf;
}
.org-secondary-selection {
    /* secondary-selection */
    background-color: #ffff00;
}
.org-shadow {
    /* shadow */
    color: #7f7f7f;
}
.org-show-paren-match {
    /* show-paren-match */
    background-color: #40e0d0;
}
.org-show-paren-mismatch {
    /* show-paren-mismatch */
    color: #ffffff;
    background-color: #a020f0;
}
.org-string {
    /* font-lock-string-face */
    color: #bc8f8f;
}
.org-texinfo-heading {
    /* texinfo-heading */
    color: #0000ff;
}
.org-tool-bar {
    /* tool-bar */
    color: #000000;
    background-color: #bfbfbf;
}
.org-tooltip {
    /* tooltip */
    color: #000000;
    background-color: #ffffe0;
}
.org-trailing-whitespace {
    /* trailing-whitespace */
    background-color: #ff0000;
}
.org-type {
    /* font-lock-type-face */
    color: #228b22;
}
.org-underline {
    /* underline */
    text-decoration: underline;
}
.org-variable-name {
    /* font-lock-variable-name-face */
    color: #b8860b;
}
.org-variable-pitch {
}
.org-vertical-border {
}
.org-warning {
    /* font-lock-warning-face */
    color: #ff0000;
    font-weight: bold;
}



.logo-link {
    position: fixed;
    top: 10px;
    left: 30px;
}

/* These style are only for IE: */

* html {
    overflow: hidden;
    padding-bottom:0px;
    margin:0px;
}

* html body {
    height: 100%;
    overflow:auto;
    font-size: 100%;
    margin: 0px 0px 0px 250px;
    padding: 0px 10% 0px 0px;
}
/* 针对Ie ,好像因为iexplore 不认识position:fixed 所以没办法让
   导航部分的显示固定在特定的位置，不随滚动条而滚动
 */
* html #table-of-contents {
    position: absolute;
    width:200px;
    left:10px
    /*
      The evil IE-JavaScript hack :-) depends on Picture and y-distance.
      Added to support small screens (Netbooks...).
      */
    top: expression( ( 30 + ( noValue = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop ) ) + 'px' );
    /* top: expression((document.body.clientHeight - 210) + "px"); */
     /* height: expression((document.body.clientHeight - 210) + "px"); */
}
* html #org-div-home-and-up {
    position: absolute;
    width:200px;
    right:25px;
    /*
      The evil IE-JavaScript hack :-) depends on Picture and y-distance.
      Added to support small screens (Netbooks...).
      */
    /* top: expression( ( 10 + ( noValue = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop ) ) + 'px' ); */
    /* top: expression((document.body.clientHeight - 210) + "px"); */
     /* height: expression((document.body.clientHeight - 210) + "px"); */
}
* html #org-src{
    position: absolute;
    width:25px;
    right:20px;
}
* html #htmlized-src{
    position: absolute;
    width:120px;
    right:20px;
}

* html p.author{
    position: absolute;
    width:125px;
    left:20px;
}
* html p.date{
    position: absolute;
    width:225px;
    left:20px;
    bottom:0px;
}
* html p.creator{
    position: absolute;
    width:425px;
    left:20px;
    bottom:20px;
}

* html h1 {
    margin-top:10px;
}

* html .logo-link {
    position: absolute;
    top: 10px;
    left: 30px;
}

* html #logo-text{
    font-size: 75%;
	position: absolute;
	display: block;
	right: 10px;
	bottom: 3px;
	overflow:hidden;
}
 
 
* html div#tags {
	font-size: 75%;
	/* line-height: 1.4em; */
	position: absolute;
	display: block;
	right: -2px;
	top: 10%;
	width: 150px;
	/* min-height:60px; */
	max-height:95%;
	/* overflow:visible; */
    /* white-space:pre-wrap; */
}

    </style>
<link rel="stylesheet" type="text/css" href="../style/emacs.css" />
<script type='text/javascript' src='../js/emacs.js'> </script>

</head>
<body>
<div id="org-div-home-and-up" style="text-align:right;font-size:70%;white-space:nowrap;">
 <a accesskey="h" href="../sitemap.html"> 站点地图 </a>
 |
 <a accesskey="H" href="../index.html"> 首页 </a>
</div>

<div id="preamble">

</div>

<div id="content">
<h1 class="title">iptables防火墙</h1>


<div id='logo-img' ><a  href='../index.html'>▇█▓▒░◕~◕░▒▓█▇</a></div>

<div id='logo-text'>
  <a href='#' ><span align="left">░◕~◕░</span></a>
</div>


<pre class="src src-sh"><span class="org-comment-delimiter"># </span><span class="org-comment">&#20116;&#20010;&#26816;&#26597;&#28857;PREROUTING &#65292;FORWARD POSTROUTING INPUT OUTPUT</span>
<span class="org-comment-delimiter">#   </span><span class="org-comment">&#19968;&#20010;&#25968;&#25454;&#21253;&#20174;prerouting &#36827;&#20837;&#25105;&#30340;&#26426;&#22120;&#65292;&#23427;&#26377;&#20004;&#20010;&#21435;&#21521;&#65292;&#19968;&#26159;&#32463;&#36807;input &#35775;&#38382;&#25105;&#26426;&#22120;&#19978;&#30340;&#24212;&#29992;&#31243;&#24207;&#65292;&#21518;&#32463;output ,postrouting</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">&#27969;&#36208;&#65292;&#21478;&#19968;&#20010;&#21435;&#21521;&#26159;&#65306;&#30452;&#25509;&#32463;forward postrouting &#27969;&#21521;&#21035;&#30340;&#26426;&#22120;&#65292;&#20063;&#23601;&#26159;&#35828;&#25105;&#30340;&#26426;&#22120;&#21482;&#26159;&#20805;&#24403;&#36335;&#30001;&#65292;&#25968;&#25454;&#21253;&#32463;&#25105;&#30340;&#26426;&#22120;&#21040;&#20854;&#20182;&#26426;&#22120;&#19978;</span>
<span class="org-comment-delimiter">#</span>
<span class="org-comment-delimiter">#      </span><span class="org-comment">PREROUTING ----------------&gt;FORWARD---------------------&gt; POSTROUTING</span>
<span class="org-comment-delimiter">#                   </span><span class="org-comment">|                                ^</span>
<span class="org-comment-delimiter">#                   </span><span class="org-comment">|                                |</span>
<span class="org-comment-delimiter">#                   </span><span class="org-comment">INPUT                           OUTPUT</span>
<span class="org-comment-delimiter">#                   </span><span class="org-comment">|                                |</span>
<span class="org-comment-delimiter">#                   </span><span class="org-comment">v                                |</span>
<span class="org-comment-delimiter">#                    </span><span class="org-comment">---&gt;&#25105;&#26426;&#22120;&#19978;&#30340;&#24212;&#29992;&#31243;&#24207;----------&gt;</span>
<span class="org-comment-delimiter">#</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">iptables &#30340;&#32467;&#26500;&#30001;&#19978;&#21040;&#19979;&#26159;:&#34920;(table)&#65292;&#35268;&#21017;&#38142;(chain)&#65292;&#35268;&#21017;(rule) &#65292;&#34920;&#30001;&#35268;&#21017;&#38142;&#32452;&#25104;&#65292;&#35268;&#21017;&#38142;&#30001;&#19968;&#26465;&#26465;&#35268;&#21017;&#32452;&#25104;</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">iptables &#40664;&#35748;&#26377;&#19977;&#24352;&#34920;filter ,nat ,mangle ,   &#20351;&#29992;-t &#21442;&#25968;&#25351;&#23450;&#23545;&#21738;&#24352;&#34920;&#25805;&#20316;&#65292;&#22914;&#26524;&#19981;&#25351;&#23450;,&#21017;&#40664;&#35748;&#26159;&#23545;filter &#34920;&#36827;&#34892;&#25805;&#20316;</span>
<span class="org-comment-delimiter">#</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">filter &#40664;&#35748;&#26377;&#19977;&#26465;&#20869;&#24314;&#30340;&#35268;&#21017;&#38142;, INPUT FORWARD OUTPUT</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">nat     &#12290;&#12290;&#12290;&#12290;&#12290;&#12290;&#12290;&#12290;&#12290;&#12290;&#12290; POSTROUTING ,OUTPUT PREROUTING</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">mangle  .....&#20004;.............    OUTPUT PREROUTING</span>
<span class="org-comment-delimiter">#</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">iptables &#21629;&#20196;&#30340;&#19968;&#33324;&#26684;&#24335; iptables [ -t table]  &#25805;&#20316;  [ chain] [options ]</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">&#19968;&#20010;&#26597;&#23545;&#23436;&#25972;&#21442;&#25968;&#30340;&#31034;&#20363;</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">iptables -t filter      -I    INPUT 2    -i eth0  -s 10.2.1.111 --sport 1234 -d 10.2.1.123 --dport 22   -j ACCEPT</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">iptables -t filter      -I    OUTPUT 2    -i eth0  -d 10.2.1.123  --dport 22 -s 10.2.1.123  --sport 1234   -j ACCEPT</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">&#36825;&#26465;&#21629;&#20196;&#26159;&#65306;&#22312;filter &#34920;&#20013;&#30340;INPUT &#38142;&#19978; &#25554;&#20837;&#19968;&#26465;&#35268;&#21017;&#22312;2&#22788;(&#27492;&#35268;&#21017;&#25490;&#22312;&#31532;&#20108;&#20010;&#20301;&#32622;) ,&#35268;&#21017;&#30340;&#20855;&#20307;&#65306;&#20174;&#25105;&#30340;eth0 &#32593;&#21345;&#32852;&#25105;&#65292;&#19988;&#23545;&#26041;&#26426;&#30340;ip &#26159;10.2.1.111 &#23545;&#26041;&#31471;&#21475;1234,&#35775;&#38382;&#25105;&#30340;ip :10.2.1.123 &#25105;&#30340;22&#31471;&#21475; ,&#26102;&#25165;&#25509;&#21463;</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">&#28982;&#21518;&#26159;&#65292;&#20174;&#25105;&#30340;ip 10.2.1.123:22 &#21521;10.2.1.111:1234 &#32463;eth0 &#32593;&#21345;&#21457;&#20986;&#30340;&#21253;&#25918;&#34892;</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">iptables -F  ,&#28165;&#31354;filter &#30340;&#25152;&#26377;&#35268;&#21017;&#38142;</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">iptables -t nat -F &#28165;&#31354;nat &#34920;&#30340;&#25152;&#26377;&#35268;&#21017;&#38142;</span>
<span class="org-comment-delimiter">###################################################################################################</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">&#20851;&#20110;INPUT ,OUTPUT &#37117;&#26159;&#30456;&#23545;&#20110;&#8220;&#25105;&#8221;&#36825;&#21488;&#26426;&#22120;&#65292;&#21363;INPUT  &#65306;&#34920;&#31034;&#21521;&#25105;&#36755;&#20837;&#25968;&#25454;&#65292;OUTPUT &#34920;&#31034;&#8220;&#25105;&#8221;&#21521;&#22806;&#36755;&#20986;&#25968;&#25454;</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">&#32780;-s -d --sport --dport &#20998;&#21035;&#34920;&#31034; &#28304;ip(source) ,&#30446;&#26631;ip(destination) ,&#28304;ip&#30340;&#31471;&#21475;&#65292;&#30446;&#26631;ip&#30340;&#31471;&#21475;</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">&#24403;&#22312;&#23545;INPUT &#20316;&#22788;&#29702;&#30340;&#26102;&#20505;&#65292;-s &#25351;&#30340;&#26159;&#23545;&#26041;&#30340;&#26426;&#22120;&#65292;-d  &#25351;&#30340;&#26159;&#25105;&#36825;&#21488;&#26426;&#22120;,&#22240;&#20026;&#25968;&#25454;&#26159;&#20174;&#23545;&#26041;&#30340;&#26426;&#22120;&#27969;&#21521;&#25105;&#30340;&#65292;</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">&#32780;&#23545;OUTPUT &#20316;&#22788;&#29702;&#30340;&#26102;&#20505;   -s &#25351;&#30340;&#26159;&#25105;&#65292;&#32780;-d &#25351;&#30340;&#26159;&#23545;&#26041;&#30340;&#26426;&#22120;</span>

<span class="org-comment-delimiter">#</span><span class="org-comment">&#27491;&#30830;&#20351;&#29992;&#38450;&#28779;&#22681;&#65292;&#19968;&#33324;&#40664;&#35748;&#35774;&#20026;&#25298;&#32477;&#25152;&#26377;&#65292;&#28982;&#21518;&#21482;&#24320;&#25918;&#38656;&#35201;&#24320;&#25918;&#30340;&#65292;&#32780;&#19981;&#26159;&#20801;&#25918;&#25152;&#26377;&#65292;&#21482;&#25298;&#32477;&#38656;&#35201;&#25298;&#32477;&#30340;</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">&#39318;&#20808;&#21551;&#21160;iptables &#26381;&#21153;/etc/init.d/iptables start</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">&#25105;&#29992;&#30340;&#26159;gentoo &#31995;&#32479;&#35013;&#19978;iptables &#21518;&#65292;&#31532;&#19968;&#27425;&#36816;&#34892; &#23427;&#23427;&#25552;&#31034;&#25105;&#35201;&#20808;&#36816;&#34892;/etc/init.d/iptables save &#65292;&#22909;&#20687;&#26159;&#20570;&#19968;&#20123;&#21021;&#22987;&#21270;&#25110;&#32773;&#20445;&#23384;&#19968;&#20123;&#25991;&#20214;&#65292;</span>
/etc/init.d/iptables save
/etc/init.d/iptables start
<span class="org-comment-delimiter">#</span><span class="org-comment">&#21551;&#21160;&#21518;&#30475;&#19968;&#19979;&#40664;&#35748;&#30340;&#35775;&#38382;&#35268;&#21017;</span>
iptables -L &#25110;&#32773;iptables -L --line-number &#26174;&#31034;&#34892;&#21495;&#65292; -v &#35814;&#32454;&#20449;&#24687;
Chain INPUT (policy ACCEPT)
target     prot opt source               destination

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination
<span class="org-comment-delimiter">#</span><span class="org-comment">&#40664;&#35748;&#24773;&#20917;&#19979;&#26159;policy &#26159;ACCEPT    &#65292;&#31561;&#20110;&#27809;&#26377;&#38450;&#28779;&#22681;,&#29616;&#22312;&#20462;&#25913;&#40664;&#35748;&#30340;policy</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">&#27880;&#24847;&#21315;&#19975;&#19981;&#35201;&#20351;&#29992;&#36828;&#31243;ssh &#36830;&#25509;&#36827;&#34892;&#36825;&#20010;&#25805;&#20316;&#65292;&#22240;&#20026;&#23427;&#20063;&#20250;&#20851;&#38381;ssh &#20351;&#29992;&#30340;22 &#31471;&#21475;&#65292;</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">&#20351;&#29992;ssh &#36830;&#25509; &#65292;&#39318;&#20808;&#24320;&#25918;&#20102;22 &#31471;&#21475;&#20877;&#36827;&#34892;&#19979;&#38754;&#19977;&#26465;&#21629;&#20196;</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">sshd</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">&#20801;&#35768;&#20219;&#20309;&#26426;&#22120;&#21521;&#25105;&#30340;22 &#31471;&#21475;&#21457;&#20986;&#35831;&#27714;</span>
<span class="org-comment-delimiter">#  </span><span class="org-comment">&#36825;&#37324;&#27809;&#29992;&#29992;-t &#21017;&#40664;&#35748;&#26159;-t filter</span>
                        iptables -A INPUT  -p tcp --dport 22      -j ACCEPT
<span class="org-comment-delimiter"># </span><span class="org-comment">&#31561;&#20215;&#20110;:iptables -t filter  -A INPUT  -p tcp --dport 22      -j ACCEPT</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">&#20801;&#35768;&#25105;&#30340;22&#31471;&#21475;&#21521;&#22806;&#36755;&#20986;&#25968;&#25454;</span>
                        iptables -A OUTPUT  -p tcp --sport 22      -j ACCEPT
<span class="org-comment-delimiter">#</span><span class="org-comment">&#22914;&#26524;&#21482;&#38480;&#26576;&#20123;&#29305;&#23450;ip &#30340;&#26426;&#22120;&#35775;&#38382;&#25105;,&#19978;&#38754;&#20004;&#26465;&#35201;&#25442;&#25104;</span>
                        iptables -A INPUT  -p tcp --dport 22  -s 10.2.1.110     -j ACCEPT
                        iptables -A OUTPUT  -p tcp --sport 22 -d 10.2.1.110     -j ACCEPT
<span class="org-comment-delimiter">#</span><span class="org-comment">&#29616;&#22312;&#21482;&#26377;ip&#20026;10.2.1.110&#30340;ip &#21487;&#20197;&#35775;&#38382;&#25105;</span>
<span class="org-comment-delimiter">#</span>
iptables -P INPUT  DROP
iptables -P OUTPUT DROP
iptables -P FORWARD DROP

<span class="org-comment-delimiter">#</span><span class="org-comment">&#40664;&#35748;&#30340;&#31574;&#30053;&#21482;&#33021;&#26159;ACCEPT &#65292;DROP &#65292;&#19981;&#33021;&#26159;REJECT</span>
Chain INPUT (policy DROP)
target     prot opt source               destination

Chain FORWARD (policy DROP)
target     prot opt source               destination

Chain OUTPUT (policy DROP)
target     prot opt source               destination
<span class="org-comment-delimiter">#</span><span class="org-comment">&#29616;&#22312;&#26080;&#35770;INPUT ,OUTPUT ,FORWARD &#40664;&#35748;&#37117;&#26159;&#20002;&#21253;(drop&#25298;&#32477;)&#65292;&#32780;&#19981;&#26159;accept &#25509;&#21463;</span>

<span class="org-comment-delimiter">#</span><span class="org-comment">&#27492;&#26102;&#25105;&#26497;&#24230;&#23433;&#20840;&#65292;&#31561;&#20110;&#27809;&#36830;&#32593;&#65292;&#25105;&#19981;&#33021;&#35775;&#38382;&#21035;&#20154;&#65292;&#21035;&#20154;&#19981;&#33021;&#35775;&#38382;&#25105;</span>

<span class="org-comment-delimiter">#</span><span class="org-comment">&#29616;&#22312;&#25105;&#24819;&#19978;&#32593;</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">&#20551;&#22914;&#25105;&#24819;&#35775;&#38382;&#23545;&#26041;&#30340;80 &#31471;&#21475;&#65292;&#20854;&#23454;&#21253;&#25324;&#20102;&#20004;&#20010;&#26041;&#38754;&#65292;&#19968;&#26159;&#25105;&#26377;&#26435;&#38480;&#21521;&#23545;&#26041;&#30340;80 &#31471;&#21475;&#21457;&#20986;&#35831;&#27714;&#65292;&#20108;&#26159;&#26377;&#26435;&#38480;&#20174;&#23545;&#26041;&#30340;80 &#31471;&#21475;&#21462;&#24471;&#25968;&#25454;&#65292;&#36825;&#37324;&#21482;&#35268;&#23450;&#23545;&#26041;&#30340;80 &#31471;&#21475;&#65292;&#32780;&#27809;&#26377;&#35268;&#23450;&#25105;&#20174;&#21738;&#20010;&#31471;&#21475;&#21435;&#35775;&#38382;&#23427;&#30340;80 ,&#24847;&#21619;&#30528;&#25105;&#21487;&#20197;&#20174;&#20219;&#24847;&#31471;&#21475;&#35775;&#38382;&#23545;&#26041;&#30340;80&#31471;&#21475;,&#36825;&#37324;&#31471;&#21475;&#37117;&#26159;tcp &#31867;&#22411;&#30340;</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">&#20801;&#35768;&#25105;&#21521;&#23545;&#26041;&#30340;80 &#31471;&#21475;&#21457;&#20986;&#35831;&#27714;</span>
iptables -A OUTPUT -p tcp --dport 80 -j ACCEPT
<span class="org-comment-delimiter">#</span><span class="org-comment">&#20801;&#35768;&#23545;&#26041;&#30340;80 &#31471;&#21475;&#21521;&#25105;&#36820;&#22238;&#25968;&#25454;</span>
iptables -A INPUT -p tcp --sport 80 -j ACCEPT

<span class="org-comment-delimiter">#</span><span class="org-comment">&#34429;&#28982;&#25105;&#20204;&#27492;&#26102;&#21487;&#20197;&#35775;&#38382;&#23545;&#26041;&#30340;80 &#31471;&#21475;&#65292;&#20294;&#26159;&#25105;&#20204;&#22312;&#27983;&#35272;&#22120;&#20013;&#36755;&#20837;www.baidu.com &#24182;&#19981;&#33021;&#26174;&#31034;&#23545;&#26041;&#30340;&#32593;&#39029;&#65292;&#20294;&#26159;http://202.108.22.142/ &#30830;&#21487;&#20197;&#12290;&#22240;&#20026;&#22312;&#36825;&#20010;&#36807;&#31243;&#20013;&#36824;&#35201;&#36827;&#34892;dns&#22495;&#21517;&#35299;&#26512;,&#21448;&#35201;&#26377;&#21478;&#19968;&#20010;&#26435;&#38480;&#65292;&#37027;&#23601;&#26159;&#20801;&#35768;&#25105;&#21521;dns server &#30340;udp 53 &#31471;&#21475;&#35831;&#27714;&#65292;&#24182;&#20801;&#35768;&#20174;&#23427;&#36820;&#22238;&#25968;&#25454;</span>
 iptables -A OUTPUT -p udp --dport 53 -j ACCEPT
 iptables -A INPUT -p udp --sport 53 -j ACCEPT
<span class="org-comment-delimiter"># </span><span class="org-comment">&#36825;&#37324;&#27809;&#26377;&#25351;&#23450;dns server &#30340;ip &#22320;&#22336;&#65292;&#22914;&#26524;&#24819;&#36793;dns server &#30340;ip &#20063;&#20570;&#38480;&#23450;&#30340;&#35805;</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">&#21487;&#20197;&#36825;&#26679;&#20889;</span>
 iptables -A OUTPUT -p udp -d 211.64.208.1 --dport 53 -j ACCEPT
 iptables -A INPUT -p udp -s 211.64.208.1  --sport 53 -j ACCEPT

<span class="org-comment-delimiter">#</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">&#25105;&#26657;&#22253;&#32593;&#29992;drcom &#36827;&#34892;&#27969;&#37327;&#35745;&#36153;&#35201;&#24320;upd 61440 &#31471;&#21475;</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">drcom</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">&#20801;&#35768;211.64.208.160 &#20174;&#23427;&#30340;61440 (sport) &#31471;&#21475;&#36830;&#25509;&#21040;&#25105;&#30340;&#26426;&#22120;&#30340;61440 (dport)</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">-s &#34920;&#31034;&#28304;&#65292;&#34920;&#31034;&#20174;&#21738;&#21488;&#26426;&#22120;&#21521;&#25105;&#21457;&#36865;&#25968;&#25454;</span>
iptables -A INPUT  -p udp --sport 61440 --dport 61440 -s 211.64.208.160 -j ACCEPT
<span class="org-comment-delimiter">#</span><span class="org-comment">&#20801;&#35768; &#25105;&#30340;&#26426;&#22120; &#20174;61440(sport) &#31471;&#21475; &#21521;211.64.208.160 &#30340;61440(dport)&#31471;&#21475;&#21457;&#36865;&#25968;&#25454;</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">-d &#25351;&#23450;&#23545;&#26041;&#26426;&#22120;(&#30446;&#26631;&#26426;&#22120;)</span>
iptables -A OUTPUT  -p udp --sport 61440 --dport 61440 -d 211.64.208.160 -j ACCEPT

<span class="org-comment-delimiter">#</span><span class="org-comment">&#30446;&#21069;&#20026;&#27490;&#65292;&#37117;&#26159;&#20316;&#20026;&#19968;&#20010;&#23458;&#25143;&#21435;&#35775;&#38382;&#21035;&#20154;&#65292;&#22914;&#26524;&#25105;&#35201;&#22312;&#25105;&#30340;&#30005;&#33041;&#19978;&#26550;&#35774;&#20010;&#26381;&#21153;&#22120;&#21448;&#24403;&#22914;&#20309;&#21602;&#65292;&#27604;&#22914;&#26550;&#35774;sshd &#21450;web &#26381;&#21153;&#22120;</span>

<span class="org-comment-delimiter">#</span><span class="org-comment">web&#26381;&#21153;&#22120;&#65292;&#24320;&#25918;80&#31471;&#21475;</span>
iptables -A INPUT -p tcp  --dport 80 -j ACCEPT
iptables -A OUTPUT  -p tcp  --sport 80 -j ACCEPT



<span class="org-comment-delimiter">#</span><span class="org-comment">&#24320;&#25918;ftp &#26381;&#21153;</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">iptables -A INPUT -m state &#8211;state ESTABLISHED,RELATED -j ACCEPT</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">&#20801;&#35768;&#36830;&#25509;&#20445;&#25345;&#30340;&#34987;&#21160;&#35775;&#38382;&#12290;</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">ftp&#21327;&#35758;&#26159;&#19968;&#20010;&#31616;&#21333;&#12289;&#20445;&#23494;&#24615;&#24046;&#65288;&#26126;&#30721;&#65289;&#30340;tcp&#21327;&#35758;&#65292;&#23427;&#30340;&#24037;&#20316;&#21407;&#29702;&#26159;&#23458;&#25143;&#31471;&#20808;&#36830;&#26381;&#21153;&#22120;&#31471;&#30340;21&#31471;&#21475;&#65292;&#28982;&#21518;&#32463;&#36807;3&#27493;&#30340;&#25569;&#25163;&#20197;&#21518;&#24314;&#31435;&#20102;&#19968;&#26465;&#36830;&#25509;&#12290;&#35201;&#27880;&#24847;&#30340;&#26159;&#65292;&#36825;&#26465;&#36830;&#25509;&#21482;&#21487;&#20197;&#29992;&#26469;&#20256;&#36755;ftp&#30340;&#21629;&#20196;&#65292;&#21482;&#26377;&#36825;&#26465;&#36830;&#25509;&#30340;&#35805;&#26159;&#20160;&#20040;&#37117;&#20256;&#19981;&#20102;&#30340;&#65292;&#23601;&#31639;&#26159;&#29992;&#8220;ls&#8221;&#21629;&#20196;&#26469;&#26597;&#30475;&#25991;&#20214;&#20063;&#19981;&#34892;&#12290;</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">&#24314;&#31435;&#20102;&#21629;&#20196;&#30340;&#36830;&#25509;&#20197;&#21518;&#65292;&#26381;&#21153;&#22120;&#31471;&#23601;&#35201;&#24314;&#31435;&#19968;&#26465;&#25968;&#25454;&#30340;&#36830;&#25509;&#12290;&#25968;&#25454;&#30340;&#36830;&#25509;&#21448;&#20998;&#20026;&#20027;&#21160;&#27169;&#24335;&#65288;port&#65289;&#21644;&#34987;&#21160;&#27169;&#24335;&#65288;passive&#65289;&#12290;ftp&#40664;&#35748;&#26159;&#34987;&#21160;&#27169;&#24335;&#65292;&#20027;&#21160;&#21644;&#34987;&#21160;&#20043;&#38388;&#20351;&#29992;"pass"&#21629;&#20196;&#20999;&#25442;&#12290;&#20027;&#21160;&#27169;&#24335;&#36890;&#36807;20&#31471;&#21475;&#19982;&#23458;&#25143;&#31471;&#30456;&#36830;&#65292;&#32780;&#34987;&#21160;&#27169;&#24335;&#21364;&#20351;&#29992;1024&#20197;&#21518;&#30340;&#31471;&#21475;&#19982;&#23458;&#25143;&#31471;&#30456;&#36830;&#12290;&#30001;&#20110;1024&#20197;&#21518;&#30340;&#31471;&#21475;&#26159;&#38543;&#26426;&#20998;&#37197;&#30340;&#65292;&#25152;&#20197;&#22312;&#34987;&#21160;&#27169;&#24335;&#19979;&#25105;&#20204;&#26159;&#19981;&#30693;&#36947;&#26381;&#21153;&#31471;&#26159;&#20351;&#29992;&#20160;&#20040;&#31471;&#21475;&#19982;&#23458;&#25143;&#31471;&#36830;&#25509;&#30340;&#12290;&#20063;&#23601;&#26159;&#35828;&#65292;&#25105;&#20204;&#26159;&#19981;&#30693;&#36947;iptables&#35201;&#24320;&#25918;&#20160;&#20040;&#31471;&#21475;&#12290;</span>
<span class="org-comment-delimiter">#</span>
<span class="org-comment-delimiter">#</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">1 &#22312;/etc/conf.d/iptables&#37197;&#32622;&#25991;&#20214;&#20013; &#21152;&#20837; &#22914;&#19979;&#35821;&#21477;(&#19981;&#21516;&#21457;&#34892;&#29256;&#21487;&#33021;&#25991;&#20214;&#20301;&#32622;&#19981;&#21516;)</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">IPTABLES_MODULES="ip_conntrack_ftp"</span>
<span class="org-comment-delimiter">#</span>
iptables -A INPUT  -m state --state ESTABLISHED,RELATED -j ACCEPT
iptables -A OUTPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

iptables -A INPUT -p tcp --dport 21 -j ACCEPT
iptables -A OUTPUT -p tcp --sport 21 -j ACCEPT

<span class="org-comment-delimiter">#</span><span class="org-comment">&#20027;&#21160;&#27169;&#24335;&#20351;&#29992;20&#31471;&#21475;</span>
iptables -A OUTPUT -p tcp --sport 20 -j ACCEPT
iptables -A INPUT -p tcp --dport 20 -j ACCEPT


<span class="org-comment-delimiter">#</span><span class="org-comment">&#23545;&#20110;lo &#35774;&#22791;&#30340;&#25968;&#25454;&#21253;&#37117;&#25918;&#34892; &#65292;&#20063;&#23601;&#26159;&#26412;&#26426;&#25968;&#25454; -i &#34920;&#31034;&#36755;&#20837;&#65292;-o &#34920;&#31034;&#36755;&#20986;</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">&#34920;&#31034;&#25152;&#26377;&#20174;lo &#26469;&#30340;&#25968;&#25454;accept</span>
iptables  -t filter  -I  INPUT l -i lo  -j ACCEPT
<span class="org-comment-delimiter">#</span><span class="org-comment">&#34920;&#31034;&#27969;&#21521;lo &#30340;&#25968;&#25454;accept</span>
iptables  -t filter  -I   OUTPUT 1 -o lo  -j ACCEPT
<span class="org-comment-delimiter">#</span>
<span class="org-comment-delimiter">#</span>
<span class="org-comment-delimiter">#</span>
<span class="org-comment-delimiter">#</span>

<span class="org-comment-delimiter">#</span><span class="org-comment">&#20851;&#20110;&#22320;&#22336;&#36716;&#25442;&#65292;&#19968;&#33324;&#26159;&#22312;&#32593;&#20851;&#19978;&#20316;&#25805;&#20316;&#65292;&#32593;&#20851;&#19978;&#19968;&#33324;&#26377;&#20004;&#20010;&#32593;&#21345;&#65292;&#19968;&#20010;&#26377;&#22806;&#32593;&#30340;&#22320;&#22336;&#65292;&#21487;&#20197;&#19982;&#22806;&#32593;&#20114;&#35775;&#65292;&#19968;&#20010;&#26377;&#20869;&#32593;&#30340;ip&#65292;&#21487;&#20197;&#19982;&#20869;&#32593;&#20114;&#35775;&#12290;&#38656;&#35201;&#22320;&#22336;&#36716;&#25442;&#30340;&#24773;&#20917;&#65306;&#26381;&#21153;&#26550;&#35774;&#22312;&#20869;&#32593;&#30340;&#26576;&#21488;&#26426;&#19978;&#65292;&#22806;&#32593;&#36890;&#36807;&#35775;&#38382;&#32593;&#20851;&#30340;80&#31471;&#21475;&#65292;&#21017;&#35748;&#20026;&#26159;&#35775;&#38382;&#36825;&#21488;&#20869;&#32593;&#30340;80&#31471;&#21475;&#65292;&#21363;&#20445;&#25252;&#20869;&#32593;&#26381;&#21153;&#22120;&#65292;&#21478;&#19968;&#31181;&#24773;&#20917;&#65292;&#20869;&#32593;&#26426;&#22120;&#35775;&#38382;&#22806;&#32593;&#65292;&#21017;&#23558;&#20869;&#32593;&#21457;&#20986;&#30340;&#25968;&#25454;&#21253;&#30340;&#28304;&#22320;&#22336;&#25913;&#25104;&#21487;&#20197;&#22806;&#32593;&#35775;&#38382;&#30340;&#20844;&#32593;ip(&#32593;&#20851;&#30340;&#22320;&#22336;),</span>
&#20869;&#32593;&#35775;&#38382;&#22806;&#32593;&#65292;&#20316;&#28304;&#22320;&#22336;&#36716;&#25442;&#65292;&#21363;&#23558;&#21457;&#20986;&#21435;&#30340;&#25968;&#25454;&#21253;&#30340;&#28304;&#22320;&#22336;&#25913;&#25104;&#22806;&#32593;&#35782;&#21035;&#25105;&#32593;&#20851;&#30340;&#22320;&#22336;&#65292;&#22312;POSTROUTING &#38142;&#19978;&#20570;&#28304;&#22320;&#22336;&#36716;&#25442;
iptables -t nat -A POSTROUTING  -s 192.168.0.0/24 -j  SNAT --to 192.168.1.1(&#32593;&#20851;&#30340;ip)
<span class="org-comment-delimiter">#</span><span class="org-comment">&#20063;&#21487;&#20197;&#19981;&#20855;&#20307;&#25351;&#23450;&#32593;&#20851;&#30340;ip ,&#22312;&#32593;&#20851;ip&#32463;&#24120;&#21464;&#21160;&#30340;&#24773;&#20917;&#19979;,masquerade ,&#20266;&#35013;&#30340;&#24847;&#24605;&#65292;&#34920;&#31034;&#20266;&#35013;&#25104;&#32593;&#20851;&#30340;ip</span>
iptables -t nat -A POSTROUTING -s 192.168.0.0/24 -j MASQUERADE

&#22806;&#32593;&#35775;&#38382;&#20869;&#32593;&#65306;&#19968;&#33324;&#20316;&#26381;&#21153;&#22120;&#29992;&#30340;&#26102;&#20505;&#65292;&#36825;&#31181;&#24773;&#20917;&#19968;&#33324;&#26159;&#35775;&#38382;&#32593;&#20851;&#30340;&#26576;&#20010;&#31471;&#21475;&#65292;&#28982;&#21518;&#32593;&#20851;&#30340;iptables &#23558;&#23427;&#26144;&#23556;&#25104;&#20869;&#32593;&#26576;&#21488;&#26426;&#22120;&#30340;&#23545;&#24212;&#30340;&#31471;&#21475;
&#36825;&#20010;&#26102;&#20505;&#27983;&#35272;&#37324;&#36755;&#20837;http://192.168.1.1:80 &#23454;&#38469;&#26159;&#35775;&#38382;&#20869;&#32593;&#30340;http://192.168.0.100:80 ,&#22240;&#20026;&#26159;&#20869;&#32593;&#65292;&#25152;&#20197;&#22806;&#32593;&#30452;&#25509;&#36755;&#20837;
http://192.168.0.100:80 &#26159;&#26080;&#27861;&#35775;&#38382;&#30340;,192.168.1.1 &#26159;&#32593;&#20851;&#65292;&#20063;&#23601;&#26159;&#26412;&#26426;
iptables -t nat -A PREROUTING -d 192.168.1.1 --dport 80 -j DNAT --to 192.168.0.100:80






&#23436;&#25972;&#30340;&#33050;&#26412;:
sudo /etc/init.d/iptables save
sudo /etc/init.d/iptable restart
<span class="org-comment-delimiter">#</span><span class="org-comment">&#28165;&#31354;&#34920;&#20013;&#35268;&#21017;&#38142;</span>
iptables -F
iptables -X
iptables -t nat -F
iptables -t nat -X
<span class="org-comment-delimiter">#</span><span class="org-comment">&#24320;&#25918;sshd&#26381;&#21153;</span>
iptables -A INPUT  -p tcp --dport 22      -j ACCEPT
iptables -A OUTPUT  -p tcp --sport 22      -j ACCEPT
<span class="org-comment-delimiter">#</span><span class="org-comment">&#40664;&#35748;drop &#25152;&#26377;&#21253;</span>
iptables -P INPUT  DROP
iptables -P OUTPUT DROP
iptables -P FORWARD DROP
<span class="org-comment-delimiter">#</span><span class="org-comment">&#26412;&#26426;&#35774;&#22791;&#25918;&#34892;</span>
iptables  -t filter  -I  INPUT 1 -i lo  -j ACCEPT
iptables  -t filter  -I   OUTPUT 1 -o lo  -j ACCEPT


<span class="org-comment-delimiter">#</span><span class="org-comment">dns &#26381;&#21153;&#22120;</span>
iptables -A INPUT -p udp --sport 53 -m state --state ESTABLISHED,RELATED -j ACCEPT
iptables -A INPUT -p udp --dport 53 -j ACCEPT
iptables -A INPUT -p tcp --sport 53 -j ACCEPT
iptables -A INPUT -p tcp --dport 53 -j ACCEPT

<span class="org-comment-delimiter">#</span><span class="org-comment">dns</span>
 iptables -A OUTPUT -p udp   --dport 53 -j ACCEPT
 iptables -A INPUT -p udp --sport 53  -j ACCEPT
<span class="org-comment-delimiter">#</span><span class="org-comment">&#19978;&#32593;</span>
iptables -A OUTPUT -p tcp --dport 80 -j ACCEPT
iptables -A INPUT -p tcp --sport 80 -j ACCEPT
<span class="org-comment-delimiter">#</span><span class="org-comment">drcom</span>
iptables -A INPUT  -p udp --sport 61440 --dport 61440 -s 211.64.208.160 -j ACCEPT
iptables -A OUTPUT  -p udp --sport 61440 --dport 61440 -d 211.64.208.160 -j ACCEPT
<span class="org-comment-delimiter"># </span><span class="org-comment">ftp</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">&#22312;&#37197;&#32622;&#25991;&#20214;&#20013;&#21152;&#20837;  IPTABLES_MODULES="ip_conntrack_ftp"</span>
iptables -I INPUT  2 -m state --state ESTABLISHED,RELATED -j ACCEPT
iptables -I OUTPUT 2  -m state --state ESTABLISHED,RELATED -j ACCEPT
iptables -A INPUT -p tcp --dport 21 -j ACCEPT
iptables -A OUTPUT -p tcp --sport 21 -j ACCEPT
iptables -A OUTPUT -p tcp --sport 20 -j ACCEPT
iptables -A INPUT -p tcp --dport 20 -j ACCEPT
<span class="org-comment-delimiter">#</span><span class="org-comment">web &#26381;&#21153;</span>
Alearcla
e
extexi
iptables -A INPUT -p tcp  --dport 80 -j ACCEPT
iptables -A OUTPUT  -p tcp  --sport 80 -j ACCEPT

<span class="org-comment-delimiter"># </span><span class="org-comment">dhcp &#65292;&#20351;&#29992;dhcp &#33719;&#24471;ip ,</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">dhcp</span>
iptables -A INPUT -p udp --sport 67 --dport 68 -j ACCEPT
</pre>


<div id='my-src'>
<div id='org-src'><a href='../src/Linux/iptables.org'>src</a></div>
<div id='htmlized-src'><a href='../htmlized-src/Linux/iptables.org.html'>htmlized-src</a></div>
</div>
<div id='tags'><span id='tags-title'>Tags:</span><br />
<p>
    <a href="../tags/@SVN.html">@SVN</a><br/>
    <a href="../tags/@perl.html">@perl</a><br/>
    <a href="../tags/@Java.html">@Java</a><br/>
    <a href="../tags/@Mysql.html">@Mysql</a><br/>
    <a href="../tags/@Erlang.html">@Erlang</a><br/>
    <a href="../tags/@SQL.html">@SQL</a><br/>
    <a href="../tags/@DB.html">@DB</a><br/>
    <a href="../tags/@Oracle.html">@Oracle</a><br/>
    <a href="../tags/@Ediff.html">@Ediff</a><br/>
    <a href="../tags/@Git.html">@Git</a><br/>
    <a href="../tags/@Cedet.html">@Cedet</a><br/>
    <a href="../tags/@C-C++.html">@C-C++</a><br/>
    <a href="../tags/@Daily.html">@Daily</a><br/>
    <a href="../tags/@Eclipse.html">@Eclipse</a><br/>
    <a href="../tags/@AutoHotKey.html">@AutoHotKey</a><br/>
    <a href="../tags/@Windows.html">@Windows</a><br/>
    <a href="../tags/@Linux.html">@Linux</a><br/>
    <a href="../tags/@C.html">@C</a><br/>
    <a href="../tags/@Emacs.html">@Emacs</a><br/>
</p>
<p><br/>
</div>
</p></div>

<div id="postamble">
<p class="date">Date: 2012-04-29 日</p>
<p class="author">Author: 纪秀峰</p>
<p class="creator">Org version 7.8.03 with Emacs version 24</p>


</div>
<p><br/><br/>
<!-- hhmts start --> <!-- hhmts end --></p>

</body>
</html>
