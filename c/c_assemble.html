
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh" xml:lang="zh">
<head>
<title>c与汇编</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="title" content="c与汇编"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2012-04-29 日"/>
<meta name="author" content="纪秀峰"/>
<meta name="description" content="c与汇编"/>
<meta name="keywords" content=""/>
<style type='text/css'>
       body {
    background-color: #E5E5E5;
	scrollbar-face-color: #DEE3E7;
	scrollbar-highlight-color: #FFFFFF;
	scrollbar-shadow-color: #DEE3E7;
	scrollbar-3dlight-color: #D1D7DC;
	scrollbar-arrow-color:  #006699;
	scrollbar-track-color: #EFEFEF;
	scrollbar-darkshadow-color: #98AAB1;
    /* background-color: #999966;  */
    margin: 0em;
}

h1 {
    font-size: 2.0em;
    margin-top: 1.0em;
    margin-bottom: 0.3em;
}
h2 {
    font-size: 1.5em;
    margin-top: 2.4em;
    margin-bottom: 0.3em;
}
h3 {
    font-size: 1.25em;
    margin-top: 1.25em;
    margin-bottom: 0.3em;
}


div#content {
    font-family: Times, serif;
    border-left: double #333300 3mm;
    border-right: double #333300 3mm;
    letter-spacing: 0.075em;
    line-height: 1.4;
    margin: 0em auto;
    padding: 2em;
    width: 92%;
    height:100%; 
    min-height:600px;           /*firefox do'nt support height:100% ,so*/
 
}
/* #table-of-contents { */
/* 	font-size: 75%; */
/* 	line-height: 1.4em; */
/* 	position: fixed; */
/* 	display: block; */
/* 	left: -20px; */
/* 	top: 5%; */
/* 	width: 250px; */
/* 	min-height:60px; */
/* 	max-height:95%; */
/* 	overflow:hidden; */
/*     white-space:nowrap; */
/* } */

#org-div-home-and-up{
	position: fixed;
	display: block;
	right: 18px;
	top: 5px;
	overflow:auto;
    }
#org-src{
	position: fixed;
	display: block;
	right: 18px;
	top: 20px;
	overflow:hidden;
    }
#htmlized-src{
	position: fixed;
	display: block;
	right: 54px;
	top: 20px;
	overflow:hidden;
    }
#table-of-contents h2 {
	display:none;
}

#logo-text{
	position: fixed;
	display: block;
	right: 16px;
	bottom: 3px;
	overflow:hidden;
}
#logo-img{
    font-size: 60%;
	position: fixed;
	display: block;
    left: 16px;
	top: 3px;
    }
div#tags {
	font-size: 75%;
    text-align:right;
	/* line-height: 1.4em; */
	position: fixed;
	display: block;
	right: 40px;
	top: 20%;
	width: 90px;
	/* min-height:60px; */
	max-height:95%;
	/* overflow:visible; */
    /* white-space:pre-wrap; */
}

.title {
    text-align:center;
	padding-bottom: 7px;
	margin-bottom: 20px;
	border-bottom: 1px solid #222;
}
 a:link,a:active,a:visited { color : #006699; } 
 a:hover		{ text-decoration: underline; color : #DD6900; } 

.todo {color: #990000;}
.done {color: #006666;}
.timestamp-kwd {color: #444;}
.tag {color: #DDD; font-size: 70%; font-weight: 500;}

table {border: none;
       width:90%;
      }
th	{
	background-color: #006699; 
}
td	{
    padding: .1em .7em .1em .3em;
	background-color: Gainsboro
}


code {
font-family: Andale Mono, Courier New, Courier, sans-serif; font-size: 12px; line-height: 14px; color: #0000A0;
	background-color: #FAFAFA; border: #D1D7DC; border-style: solid;
	border-left-width: 1px; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px
}

/* pre { */
/* 	border: 1px solid #555; */
/* 	background: #EEEEEE; */
/* 	font-size: 9pt; */
/* 	padding: 1em; */
/* } */
pre.src {
	border: 1px solid #555;
	background:#0c1021;
    /* background:#263111; */
    color: #f7f8c6;
	font-size: 10pt;
    width:85%;
	padding: 0em;
	margin: 0;
	width: 700px;
	float: none;
	clear: none;
	line-height: 1.333;
	text-align:left;
    
    /* overflow: scroll; */
    max-height:500px;           /*IEXPLORE  don't support max-height*/
    _height:expression(this.scrollHeight > 300 ? "300px" : "auto");
    min-height:50px;
    max-width:700px;
    min-width:700px;
    overflow-x:auto;
    overflow-y:auto;
}
blockquote {
	 border: #D1D7DC;
     border-style: solid;
	border-left-width: 1px;
    border-top-width: 1px;
    border-right-width: 1px;
    border-bottom-width: 1px
    
    color: #444444;
    line-height: 125%;
	border: 1px solid #555;
    background-color: #FAFAFA;    
    width:95%;
	padding: 1em;
	margin: 0;
	float: none;
	clear: none;
	text-align:left;
    font-style:italic;
    
    /* overflow: scroll; */
    max-height:300px;           /*IEXPLORE  don't support max-height*/
    _height:expression(this.scrollHeight > 300 ? "300px" : "auto");
    min-height:20px;
    max-width:700px;
    min-width:700px;
    overflow-x:auto;
    overflow-y:auto;
}

.org-function-name {
    /* font-lock-function-name-face */
    /* color: #0000ff; */
     color: #87cefa;
     font-stretch: normal;
     text-decoration: none;
}

.org-keyword {
    /* font-lock-keyword-face */
    color: #00ffff;
    text-decoration: none;
    /* color: #a020f0; */
}
.org-doc
 { color: #ffa07a;
   text-decoration: none;
 }
p.author{
    font-size:80%;
    color:#556b2f;
    font-style:italic;
    position:fixed;
    left:10px;
    bottom:40px;
}
p.date{
    font-size:80%;
    color:#556b2f;
    font-style:italic;
    position:fixed;
    left:10px;
    bottom:0px;
}
p.creator{
    font-size:80%;
    color:#556b2f;
    font-style:italic;
    position:fixed;
    left:10px;
    bottom:20px;
}

img {
    display:inline;
	border: none;
    float:none;
    clear:none;
    left:10px;
}

.share img {
	opacity: .4;
	-moz-opacity: .4;
	filter: alpha(opacity=40);
}

.share img:hover {
	opacity: 1;
	-moz-opacity: 1;
	filter: alpha(opacity=100);
}

.org-info-search-highlight
{
	background-color:#adefef; /* same color as emacs default */
	color:#000000;
	font-weight:bold;
}

.org-bbdb-company {
    /* bbdb-company */
    font-style: italic;
}
.org-bbdb-field-name {
}
.org-bbdb-field-value {
}
.org-bbdb-name {
    /* bbdb-name */
    text-decoration: underline;
}
.org-bold {
    /* bold */
    font-weight: bold;
}
.org-bold-italic {
    /* bold-italic */
    font-weight: bold;
    font-style: italic;
}
.org-border {
    /* border */
    background-color: #000000;
}
.org-buffer-menu-buffer {
    /* buffer-menu-buffer */
    font-weight: bold;
}
.org-builtin {
    /* font-lock-builtin-face */
    color: #da70d6;
}
.org-button {
    /* button */
    text-decoration: underline;
}
.org-c-nonbreakable-space {
    /* c-nonbreakable-space-face */
    background-color: #ff0000;
    font-weight: bold;
}
.org-calendar-today {
    /* calendar-today */
    text-decoration: underline;
}
.org-comment {
    /* font-lock-comment-face */
    color: #b22222;
}
.org-comment-delimiter {
    /* font-lock-comment-delimiter-face */
    color: #b22222;
}
.org-constant {
    /* font-lock-constant-face */
    color: #5f9ea0;
}
.org-cursor {
    /* cursor */
    background-color: #000000;
}
.org-default {
    /* default */
    color: #000000;
    background-color: #ffffff;
}
.org-diary {
    /* diary */
    color: #ff0000;
}
.org-escape-glyph {
    /* escape-glyph */
    color: #a52a2a;
}
.org-file-name-shadow {
    /* file-name-shadow */
    color: #7f7f7f;
}
.org-fixed-pitch {
}
.org-fringe {
    /* fringe */
    background-color: #f2f2f2;
}
.org-header-line {
    /* header-line */
    color: #333333;
    background-color: #e5e5e5;
}
.org-help-argument-name {
    /* help-argument-name */
    font-style: italic;
}
.org-highlight {
    /* highlight */
    background-color: #b4eeb4;
}
.org-holiday {
    /* holiday */
    background-color: #ffc0cb;
}
.org-info-header-node {
    /* info-header-node */
    color: #a52a2a;
    font-weight: bold;
    font-style: italic;
}
.org-info-header-xref {
    /* info-header-xref */
    color: #0000ff;
    text-decoration: underline;
}
.org-info-menu-header {
    /* info-menu-header */
    font-weight: bold;
}
.org-info-menu-star {
    /* info-menu-star */
    color: #ff0000;
}
.org-info-node {
    /* info-node */
    color: #a52a2a;
    font-weight: bold;
    font-style: italic;
}
.org-info-title-1 {
    /* info-title-1 */
    font-size: 172%;
    font-weight: bold;
}
.org-info-title-2 {
    /* info-title-2 */
    font-size: 144%;
    font-weight: bold;
}
.org-info-title-3 {
    /* info-title-3 */
    font-size: 120%;
    font-weight: bold;
}
.org-info-title-4 {
    /* info-title-4 */
    font-weight: bold;
}
.org-info-xref {
    /* info-xref */
    color: #0000ff;
    text-decoration: underline;
}
.org-isearch {
    /* isearch */
    color: #b0e2ff;
    background-color: #cd00cd;
}
.org-italic {
    /* italic */
    font-style: italic;
}
.org-lazy-highlight {
    /* lazy-highlight */
    background-color: #afeeee;
}
.org-link {
    /* link */
    color: #0000ff;
    text-decoration: underline;
}
.org-link-visited {
    /* link-visited */
    color: #8b008b;
    text-decoration: underline;
}
.org-match {
    /* match */
    background-color: #ffff00;
}
.org-menu {
}
.org-message-cited-text {
    /* message-cited-text */
    color: #ff0000;
}
.org-message-header-cc {
    /* message-header-cc */
    color: #191970;
}
.org-message-header-name {
    /* message-header-name */
    color: #6495ed;
}
.org-message-header-newsgroups {
    /* message-header-newsgroups */
    color: #00008b;
    font-weight: bold;
    font-style: italic;
}
.org-message-header-other {
    /* message-header-other */
    color: #4682b4;
}
.org-message-header-subject {
    /* message-header-subject */
    color: #000080;
    font-weight: bold;
}
.org-message-header-to {
    /* message-header-to */
    color: #191970;
    font-weight: bold;
}
.org-message-header-xheader {
    /* message-header-xheader */
    color: #0000ff;
}
.org-message-mml {
    /* message-mml */
    color: #228b22;
}
.org-message-separator {
    /* message-separator */
    color: #a52a2a;
}
.org-minibuffer-prompt {
    /* minibuffer-prompt */
    color: #0000cd;
}
.org-mm-uu-extract {
    /* mm-uu-extract */
    color: #006400;
    background-color: #ffffe0;
}
.org-mode-line {
    /* mode-line */
    color: #000000;
    background-color: #bfbfbf;
}
.org-mode-line-buffer-id {
    /* mode-line-buffer-id */
    font-weight: bold;
}
.org-mode-line-highlight {
}
.org-mode-line-inactive {
    /* mode-line-inactive */
    color: #333333;
    background-color: #e5e5e5;
}
.org-mouse {
    /* mouse */
    background-color: #000000;
}
.org-negation-char {
}
.org-next-error {
    /* next-error */
    background-color: #eedc82;
}
.org-nobreak-space {
    /* nobreak-space */
    color: #a52a2a;
    text-decoration: underline;
}
.org-org-agenda-date {
    /* org-agenda-date */
    color: #0000ff;
}
.org-org-agenda-date-weekend {
    /* org-agenda-date-weekend */
    color: #0000ff;
    font-weight: bold;
}
.org-org-agenda-restriction-lock {
    /* org-agenda-restriction-lock */
    background-color: #ffff00;
}
.org-org-agenda-structure {
    /* org-agenda-structure */
    color: #0000ff;
}
.org-org-archived {
    /* org-archived */
    color: #7f7f7f;
}
.org-org-code {
    /* org-code */
    color: #7f7f7f;
}
.org-org-column {
    /* org-column */
    background-color: #e5e5e5;
}
.org-org-column-title {
    /* org-column-title */
    background-color: #e5e5e5;
    font-weight: bold;
    text-decoration: underline;
}
.org-org-date {
    /* org-date */
    color: #a020f0;
    text-decoration: underline;
}
.org-org-done {
    /* org-done */
    color: #228b22;
    font-weight: bold;
}
.org-org-drawer {
    /* org-drawer */
    color: #0000ff;
}
.org-org-ellipsis {
    /* org-ellipsis */
    color: #b8860b;
    text-decoration: underline;
}
.org-org-formula {
    /* org-formula */
    color: #b22222;
}
.org-org-headline-done {
    /* org-headline-done */
    color: #bc8f8f;
}
.org-org-hide {
    /* org-hide */
    color: #e5e5e5;
}
.org-org-latex-and-export-specials {
    /* org-latex-and-export-specials */
    color: #8b4513;
}
.org-org-level-1 {
    /* org-level-1 */
    color: #0000ff;
}
.org-org-level-2 {
    /* org-level-2 */
    color: #b8860b;
}
.org-org-level-3 {
    /* org-level-3 */
    color: #a020f0;
}
.org-org-level-4 {
    /* org-level-4 */
    color: #b22222;
}
.org-org-level-5 {
    /* org-level-5 */
    color: #228b22;
}
.org-org-level-6 {
    /* org-level-6 */
    color: #5f9ea0;
}
.org-org-level-7 {
    /* org-level-7 */
    color: #da70d6;
}
.org-org-level-8 {
    /* org-level-8 */
    color: #bc8f8f;
}
.org-org-link {
    /* org-link */
    color: #a020f0;
    text-decoration: underline;
}
.org-org-property-value {
}
.org-org-scheduled-previously {
    /* org-scheduled-previously */
    color: #b22222;
}
.org-org-scheduled-today {
    /* org-scheduled-today */
    color: #006400;
}
.org-org-sexp-date {
    /* org-sexp-date */
    color: #a020f0;
}
.org-org-special-keyword {
    /* org-special-keyword */
    color: #bc8f8f;
}
.org-org-table {
    /* org-table */
    color: #0000ff;
}
.org-org-tag {
    /* org-tag */
    font-weight: bold;
}
.org-org-target {
    /* org-target */
    text-decoration: underline;
}
.org-org-time-grid {
    /* org-time-grid */
    color: #b8860b;
}
.org-org-todo {
    /* org-todo */
    color: #ff0000;
}
.org-org-upcoming-deadline {
    /* org-upcoming-deadline */
    color: #b22222;
}
.org-org-verbatim {
    /* org-verbatim */
    color: #7f7f7f;
    text-decoration: underline;
}
.org-org-warning {
    /* org-warning */
    color: #ff0000;
    font-weight: bold;
}
.org-outline-1 {
    /* outline-1 */
    color: #0000ff;
}
.org-outline-2 {
    /* outline-2 */
    color: #b8860b;
}
.org-outline-3 {
    /* outline-3 */
    color: #a020f0;
}
.org-outline-4 {
    /* outline-4 */
    color: #b22222;
}
.org-outline-5 {
    /* outline-5 */
    color: #228b22;
}
.org-outline-6 {
    /* outline-6 */
    color: #5f9ea0;
}
.org-outline-7 {
    /* outline-7 */
    color: #da70d6;
}
.org-outline-8 {
    /* outline-8 */
    color: #bc8f8f;
}
.org-preprocessor {
    /* font-lock-preprocessor-face */
    color: #da70d6;
}
.org-query-replace {
    /* query-replace */
    color: #b0e2ff;
    background-color: #cd00cd;
}
.org-regexp-grouping-backslash {
    /* font-lock-regexp-grouping-backslash */
    font-weight: bold;
}
.org-regexp-grouping-construct {
    /* font-lock-regexp-grouping-construct */
    font-weight: bold;
}
.org-region {
    /* region */
    background-color: #eedc82;
}
.org-rmail-highlight {
}
.org-scroll-bar {
    /* scroll-bar */
    background-color: #bfbfbf;
}
.org-secondary-selection {
    /* secondary-selection */
    background-color: #ffff00;
}
.org-shadow {
    /* shadow */
    color: #7f7f7f;
}
.org-show-paren-match {
    /* show-paren-match */
    background-color: #40e0d0;
}
.org-show-paren-mismatch {
    /* show-paren-mismatch */
    color: #ffffff;
    background-color: #a020f0;
}
.org-string {
    /* font-lock-string-face */
    color: #bc8f8f;
}
.org-texinfo-heading {
    /* texinfo-heading */
    color: #0000ff;
}
.org-tool-bar {
    /* tool-bar */
    color: #000000;
    background-color: #bfbfbf;
}
.org-tooltip {
    /* tooltip */
    color: #000000;
    background-color: #ffffe0;
}
.org-trailing-whitespace {
    /* trailing-whitespace */
    background-color: #ff0000;
}
.org-type {
    /* font-lock-type-face */
    color: #228b22;
}
.org-underline {
    /* underline */
    text-decoration: underline;
}
.org-variable-name {
    /* font-lock-variable-name-face */
    color: #b8860b;
}
.org-variable-pitch {
}
.org-vertical-border {
}
.org-warning {
    /* font-lock-warning-face */
    color: #ff0000;
    font-weight: bold;
}



.logo-link {
    position: fixed;
    top: 10px;
    left: 30px;
}

/* These style are only for IE: */

* html {
    overflow: hidden;
    padding-bottom:0px;
    margin:0px;
}

* html body {
    height: 100%;
    overflow:auto;
    font-size: 100%;
    margin: 0px 0px 0px 250px;
    padding: 0px 10% 0px 0px;
}
/* 针对Ie ,好像因为iexplore 不认识position:fixed 所以没办法让
   导航部分的显示固定在特定的位置，不随滚动条而滚动
 */
* html #table-of-contents {
    position: absolute;
    width:200px;
    left:10px
    /*
      The evil IE-JavaScript hack :-) depends on Picture and y-distance.
      Added to support small screens (Netbooks...).
      */
    top: expression( ( 30 + ( noValue = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop ) ) + 'px' );
    /* top: expression((document.body.clientHeight - 210) + "px"); */
     /* height: expression((document.body.clientHeight - 210) + "px"); */
}
* html #org-div-home-and-up {
    position: absolute;
    width:200px;
    right:25px;
    /*
      The evil IE-JavaScript hack :-) depends on Picture and y-distance.
      Added to support small screens (Netbooks...).
      */
    /* top: expression( ( 10 + ( noValue = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop ) ) + 'px' ); */
    /* top: expression((document.body.clientHeight - 210) + "px"); */
     /* height: expression((document.body.clientHeight - 210) + "px"); */
}
* html #org-src{
    position: absolute;
    width:25px;
    right:20px;
}
* html #htmlized-src{
    position: absolute;
    width:120px;
    right:20px;
}

* html p.author{
    position: absolute;
    width:125px;
    left:20px;
}
* html p.date{
    position: absolute;
    width:225px;
    left:20px;
    bottom:0px;
}
* html p.creator{
    position: absolute;
    width:425px;
    left:20px;
    bottom:20px;
}

* html h1 {
    margin-top:10px;
}

* html .logo-link {
    position: absolute;
    top: 10px;
    left: 30px;
}

* html #logo-text{
    font-size: 75%;
	position: absolute;
	display: block;
	right: 10px;
	bottom: 3px;
	overflow:hidden;
}
 
 
* html div#tags {
	font-size: 75%;
	/* line-height: 1.4em; */
	position: absolute;
	display: block;
	right: -2px;
	top: 10%;
	width: 150px;
	/* min-height:60px; */
	max-height:95%;
	/* overflow:visible; */
    /* white-space:pre-wrap; */
}

    </style>
<link rel="stylesheet" type="text/css" href="../style/emacs.css" />
<script type='text/javascript' src='../js/emacs.js'> </script>

</head>
<body>
<div id="org-div-home-and-up" style="text-align:right;font-size:70%;white-space:nowrap;">
 <a accesskey="h" href="../sitemap.html"> 站点地图 </a>
 |
 <a accesskey="H" href="../index.html"> 首页 </a>
</div>

<div id="preamble">

</div>

<div id="content">
<h1 class="title">c与汇编</h1>


<div id='logo-img' ><a  href='../index.html'>▇█▓▒░◕~◕░▒▓█▇</a></div>

<div id='logo-text'>
  <a href='#' ><span align="left">░◕~◕░</span></a>
</div>


<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">参考</a></li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1">参考</h2>
<div class="outline-text-2" id="text-1">

<p>  <a href="http://learn.akae.cn/media/ch19s01.html">http://learn.akae.cn/media/ch19s01.html</a><br/>
</p>
<p><br/>
<pre class="src src-c"><span class="org-type">int</span> <span class="org-function-name">bar</span>(<span class="org-type">int</span> <span class="org-variable-name">c</span>, <span class="org-type">int</span> <span class="org-variable-name">d</span>)
{
    <span class="org-type">int</span> <span class="org-variable-name">e</span> = c + d;
    <span class="org-keyword">return</span> e;
}

<span class="org-type">int</span> <span class="org-function-name">foo</span>(<span class="org-type">int</span> <span class="org-variable-name">a</span>, <span class="org-type">int</span> <span class="org-variable-name">b</span>)
{
    <span class="org-keyword">return</span> bar(a, b);
}

<span class="org-type">int</span> <span class="org-function-name">main</span>(<span class="org-type">void</span>)
{
    foo(2, 3);
    <span class="org-keyword">return</span> 0;
}
</pre>


如果在编译时加上-g选项（在第 10 章 gdb讲过-g选项），那么用objdump反汇编时可以把<br/>
C代码和汇编代码穿插起来显示，这样C代码和汇编代码的对应关系看得更清楚。反汇编的<br/>
结果很长，以下只列出我们关心的部分。<br/>
</p>
<p><br/>
<pre class="src src-sh">gcc -g main.c
objdump -dS a.out
</pre>

输出结果如下:<br/>
</p>
<p><br/>
<pre class="src src-c"><span class="org-constant">main</span>:     file <span class="org-type">format</span> <span class="org-variable-name">elf32</span>-i386


Disassembly of section .init:

08048294 &lt;_init&gt;:
 8048294:    55                       push   %ebp
 8048295:    89 e5                    mov    %esp,%ebp
 8048297:    83 ec 08                 sub    $0x8,%esp
 804829a:    e8 65 00 00 00           call   8048304 &lt;_start+0x24&gt;
 804829f:    e8 ec 00 00 00           call   8048390 &lt;_start+0xb0&gt;
 80482a4:    e8 d7 01 00 00           call   8048480 &lt;__libc_csu_fini+0x10&gt;
 80482a9:    c9                       leave
 80482aa:    c3                       ret

Disassembly of section .plt:

080482ac &lt;<a href="mailto:__gmon_start__&#64;plt-0x10">__gmon_start__&#64;plt-0x10</a>&gt;:
 80482ac:    ff 35 f8 9f 04 08        pushl  0x8049ff8
 80482b2:    ff 25 fc 9f 04 08        jmp    *0x8049ffc
 80482b8:    00 00                    add    %al,(%eax)
    ...

080482bc &lt;<a href="mailto:__gmon_start__&#64;plt">__gmon_start__&#64;plt</a>&gt;:
 80482bc:    ff 25 00 a0 04 08        jmp    *0x804a000
 80482c2:    68 00 00 00 00           push   $0x0
 80482c7:    e9 e0 ff ff ff           jmp    80482ac &lt;_init+0x18&gt;

080482cc &lt;<a href="mailto:__libc_start_main&#64;plt">__libc_start_main&#64;plt</a>&gt;:
 80482cc:    ff 25 04 a0 04 08        jmp    *0x804a004
 80482d2:    68 08 00 00 00           push   $0x8
 80482d7:    e9 d0 ff ff ff           jmp    80482ac &lt;_init+0x18&gt;

Disassembly of section .text:

080482e0 &lt;_start&gt;:
 80482e0:    31 ed                    xor    %ebp,%ebp
 80482e2:    5e                       pop    %esi
 80482e3:    89 e1                    mov    %esp,%ecx
 80482e5:    83 e4 f0                 <span class="org-keyword">and</span>    $0xfffffff0,%esp
 80482e8:    50                       push   %eax
 80482e9:    54                       push   %esp
 80482ea:    52                       push   %edx
 80482eb:    68 70 84 04 08           push   $0x8048470
 80482f0:    68 10 84 04 08           push   $0x8048410
 80482f5:    51                       push   %ecx
 80482f6:    56                       push   %esi
 80482f7:    68 e5 83 04 08           push   $0x80483e5
 80482fc:    e8 cb ff ff ff           call   80482cc &lt;<a href="mailto:__libc_start_main&#64;plt">__libc_start_main&#64;plt</a>&gt;
 8048301:    f4                       hlt
 8048302:    90                       nop
 8048303:    90                       nop
 8048304:    55                       push   %ebp
 8048305:    89 e5                    mov    %esp,%ebp
 8048307:    53                       push   %ebx
 8048308:    83 ec 04                 sub    $0x4,%esp
 804830b:    e8 00 00 00 00           call   8048310 &lt;_start+0x30&gt;
 8048310:    5b                       pop    %ebx
 8048311:    81 c3 e4 1c 00 00        add    $0x1ce4,%ebx
 8048317:    8b 93 fc ff ff ff        mov    -0x4(%ebx),%edx
 804831d:    85 d2                    test   %edx,%edx
 804831f:    74 05                    je     8048326 &lt;_start+0x46&gt;
 8048321:    e8 96 ff ff ff           call   80482bc &lt;<a href="mailto:__gmon_start__&#64;plt">__gmon_start__&#64;plt</a>&gt;
 8048326:    58                       pop    %eax
 8048327:    5b                       pop    %ebx
 8048328:    c9                       leave
 8048329:    c3                       ret
 804832a:    90                       nop
 804832b:    90                       nop
 804832c:    90                       nop
 804832d:    90                       nop
 804832e:    90                       nop
 804832f:    90                       nop
 8048330:    55                       push   %ebp
 8048331:    89 e5                    mov    %esp,%ebp
 8048333:    53                       push   %ebx
 8048334:    83 ec 04                 sub    $0x4,%esp
 8048337:    80 3d 10 a0 04 08 00     cmpb   $0x0,0x804a010
 804833e:    75 3d                    jne    804837d &lt;_start+0x9d&gt;
 8048340:    a1 14 a0 04 08           mov    0x804a014,%eax
 8048345:    bb 18 9f 04 08           mov    $0x8049f18,%ebx
 804834a:    81 eb 14 9f 04 08        sub    $0x8049f14,%ebx
 8048350:    c1 fb 02                 sar    $0x2,%ebx
 8048353:    4b                       dec    %ebx
 8048354:    39 d8                    cmp    %ebx,%eax
 8048356:    73 1e                    jae    8048376 &lt;_start+0x96&gt;
 8048358:    90                       nop
 8048359:    8d b4 26 00 00 00 00     lea    0x0(%esi,%eiz,1),%esi
 8048360:    40                       inc    %eax
 8048361:    a3 14 a0 04 08           mov    %eax,0x804a014
 8048366:    ff 14 85 14 9f 04 08     call   *0x8049f14(,%eax,4)
 804836d:    a1 14 a0 04 08           mov    0x804a014,%eax
 8048372:    39 d8                    cmp    %ebx,%eax
 8048374:    72 ea                    jb     8048360 &lt;_start+0x80&gt;
 8048376:    c6 05 10 a0 04 08 01     movb   $0x1,0x804a010
 804837d:    83 c4 04                 add    $0x4,%esp
 8048380:    5b                       pop    %ebx
 8048381:    c9                       leave
 8048382:    c3                       ret
 8048383:    8d b6 00 00 00 00        lea    0x0(%esi),%esi
 8048389:    8d bc 27 00 00 00 00     lea    0x0(%edi,%eiz,1),%edi
 8048390:    55                       push   %ebp
 8048391:    89 e5                    mov    %esp,%ebp
 8048393:    83 ec 18                 sub    $0x18,%esp
 8048396:    a1 1c 9f 04 08           mov    0x8049f1c,%eax
 804839b:    85 c0                    test   %eax,%eax
 804839d:    74 12                    je     80483b1 &lt;_start+0xd1&gt;
 804839f:    b8 00 00 00 00           mov    $0x0,%eax
 80483a4:    85 c0                    test   %eax,%eax
 80483a6:    74 09                    je     80483b1 &lt;_start+0xd1&gt;
 80483a8:    c7 04 24 1c 9f 04 08     movl   $0x8049f1c,(%esp)
 80483af:    ff d0                    call   *%eax
 80483b1:    c9                       leave
 80483b2:    c3                       ret
 80483b3:    90                       nop

080483b4 &lt;bar&gt;:
<span class="org-type">int</span> bar(<span class="org-type">int</span> <span class="org-variable-name">c</span>, <span class="org-type">int</span> <span class="org-variable-name">d</span>)
{
 80483b4:    55                       push   %ebp
 80483b5:    89 e5                    mov    %esp,%ebp
 80483b7:    83 ec 10                 sub    $0x10,%esp
    <span class="org-type">int</span> e = c + d;
 80483ba:    8b 45 0c                 mov    0xc(%ebp),%eax
 80483bd:    8b 55 08                 mov    0x8(%ebp),%edx
 80483c0:    8d 04 02                 lea    (%edx,%eax,1),%eax
 80483c3:    89 45 fc                 mov    %eax,-0x4(%ebp)
    <span class="org-keyword">return</span> e;
 80483c6:    8b 45 fc                 mov    -0x4(%ebp),%eax
}
 80483c9:    c9                       leave
 80483ca:    c3                       ret

080483cb &lt;foo&gt;:

<span class="org-type">int</span> foo(<span class="org-type">int</span> <span class="org-variable-name">a</span>, <span class="org-type">int</span> <span class="org-variable-name">b</span>)
{
 80483cb:    55                       push   %ebp
 80483cc:    89 e5                    mov    %esp,%ebp
 80483ce:    83 ec 08                 sub    $0x8,%esp
    <span class="org-keyword">return</span> bar(a, b);
 80483d1:    8b 45 0c                 mov    0xc(%ebp),%eax
 80483d4:    89 44 24 04              mov    %eax,0x4(%esp)
 80483d8:    8b 45 08                 mov    0x8(%ebp),%eax
 80483db:    89 04 24                 mov    %eax,(%esp)
 80483de:    e8 d1 ff ff ff           call   80483b4 &lt;bar&gt;
}
 80483e3:    c9                       leave
 80483e4:    c3                       ret

080483e5 &lt;main&gt;:

<span class="org-type">int</span> main(<span class="org-type">void</span>)
{
 80483e5:    55                       push   %ebp
 80483e6:    89 e5                    mov    %esp,%ebp
 80483e8:    83 ec 08                 sub    $0x8,%esp
    foo(2, 3);
 80483eb:    c7 44 24 04 03 00 00     movl   $0x3,0x4(%esp)
 80483f2:    00
 80483f3:    c7 04 24 02 00 00 00     movl   $0x2,(%esp)
 80483fa:    e8 cc ff ff ff           call   80483cb &lt;foo&gt;
    <span class="org-keyword">return</span> 0;
 80483ff:    b8 00 00 00 00           mov    $0x0,%eax
}
 8048404:    c9                       leave
 8048405:    c3                       ret
 8048406:    90                       nop
 8048407:    90                       nop
 8048408:    90                       nop
 8048409:    90                       nop
 804840a:    90                       nop
 804840b:    90                       nop
 804840c:    90                       nop
 804840d:    90                       nop
 804840e:    90                       nop
 804840f:    90                       nop

08048410 &lt;__libc_csu_init&gt;:
 8048410:    55                       push   %ebp
 8048411:    89 e5                    mov    %esp,%ebp
 8048413:    57                       push   %edi
 8048414:    56                       push   %esi
 8048415:    53                       push   %ebx
 8048416:    e8 00 00 00 00           call   804841b &lt;__libc_csu_init+0xb&gt;
 804841b:    5b                       pop    %ebx
 804841c:    81 c3 d9 1b 00 00        add    $0x1bd9,%ebx
 8048422:    83 ec 1c                 sub    $0x1c,%esp
 8048425:    8d bb 18 ff ff ff        lea    -0xe8(%ebx),%edi
 804842b:    e8 64 fe ff ff           call   8048294 &lt;_init&gt;
 8048430:    8d 83 18 ff ff ff        lea    -0xe8(%ebx),%eax
 8048436:    29 c7                    sub    %eax,%edi
 8048438:    c1 ff 02                 sar    $0x2,%edi
 804843b:    85 ff                    test   %edi,%edi
 804843d:    74 29                    je     8048468 &lt;__libc_csu_init+0x58&gt;
 804843f:    31 f6                    xor    %esi,%esi
 8048441:    8d b4 26 00 00 00 00     lea    0x0(%esi,%eiz,1),%esi
 8048448:    8b 45 10                 mov    0x10(%ebp),%eax
 804844b:    89 44 24 08              mov    %eax,0x8(%esp)
 804844f:    8b 45 0c                 mov    0xc(%ebp),%eax
 8048452:    89 44 24 04              mov    %eax,0x4(%esp)
 8048456:    8b 45 08                 mov    0x8(%ebp),%eax
 8048459:    89 04 24                 mov    %eax,(%esp)
 804845c:    ff 94 b3 18 ff ff ff     call   *-0xe8(%ebx,%esi,4)
 8048463:    46                       inc    %esi
 8048464:    39 fe                    cmp    %edi,%esi
 8048466:    72 e0                    jb     8048448 &lt;__libc_csu_init+0x38&gt;
 8048468:    83 c4 1c                 add    $0x1c,%esp
 804846b:    5b                       pop    %ebx
 804846c:    5e                       pop    %esi
 804846d:    5f                       pop    %edi
 804846e:    c9                       leave
 804846f:    c3                       ret

08048470 &lt;__libc_csu_fini&gt;:
 8048470:    55                       push   %ebp
 8048471:    89 e5                    mov    %esp,%ebp
 8048473:    c9                       leave
 8048474:    c3                       ret
 8048475:    90                       nop
 8048476:    90                       nop
 8048477:    90                       nop
 8048478:    90                       nop
 8048479:    90                       nop
 804847a:    90                       nop
 804847b:    90                       nop
 804847c:    90                       nop
 804847d:    90                       nop
 804847e:    90                       nop
 804847f:    90                       nop
 8048480:    55                       push   %ebp
 8048481:    89 e5                    mov    %esp,%ebp
 8048483:    53                       push   %ebx
 8048484:    83 ec 04                 sub    $0x4,%esp
 8048487:    a1 0c 9f 04 08           mov    0x8049f0c,%eax
 804848c:    83 f8 ff                 cmp    $0xffffffff,%eax
 804848f:    74 1b                    je     80484ac &lt;__libc_csu_fini+0x3c&gt;
 8048491:    bb 0c 9f 04 08           mov    $0x8049f0c,%ebx
 8048496:    8d 76 00                 lea    0x0(%esi),%esi
 8048499:    8d bc 27 00 00 00 00     lea    0x0(%edi,%eiz,1),%edi
 80484a0:    ff d0                    call   *%eax
 80484a2:    83 eb 04                 sub    $0x4,%ebx
 80484a5:    8b 03                    mov    (%ebx),%eax
 80484a7:    83 f8 ff                 cmp    $0xffffffff,%eax
 80484aa:    75 f4                    jne    80484a0 &lt;__libc_csu_fini+0x30&gt;
 80484ac:    83 c4 04                 add    $0x4,%esp
 80484af:    5b                       pop    %ebx
 80484b0:    c9                       leave
 80484b1:    c3                       ret
 80484b2:    90                       nop
 80484b3:    90                       nop

Disassembly of section .fini:

080484b4 &lt;_fini&gt;:
 80484b4:    55                       push   %ebp
 80484b5:    89 e5                    mov    %esp,%ebp
 80484b7:    53                       push   %ebx
 80484b8:    83 ec 04                 sub    $0x4,%esp
 80484bb:    e8 00 00 00 00           call   80484c0 &lt;_fini+0xc&gt;
 80484c0:    5b                       pop    %ebx
 80484c1:    81 c3 34 1b 00 00        add    $0x1b34,%ebx
 80484c7:    e8 64 fe ff ff           call   8048330 &lt;_start+0x50&gt;
 80484cc:    59                       pop    %ecx
 80484cd:    5b                       pop    %ebx
 80484ce:    c9                       leave
 80484cf:    c3                       ret
</pre>


一段一段的理解,从main 开始:<br/>
首先 栈的分配 是从高地址向低地址扩展的，所以入栈会导致栈顶地址变小。<br/>
在 <span style="text-decoration:underline;">每个函数</span> 的 <span style="text-decoration:underline;">栈帧</span> 中，ebp指向栈底，而esp指向栈顶，在 <span style="text-decoration:underline;">某一个函数</span> 执行过<br/>
程中esp随着压栈和出栈操作随时变化，而ebp是不动的，函数的参数和局部变量都是通过ebp的值加上一个偏<br/>
移量来访问<br/>
</p>
<p><br/>
</p>
<p><br/>
<pre class="src src-c"><span class="org-type">int</span> <span class="org-function-name">main</span>(<span class="org-type">void</span>)
{
&#20851;&#20110;&#36825;&#20004;&#20010;&#25805;&#20316;&#22312;foo&#20989;&#25968;&#20013;&#36827;&#34892;&#35762;&#35299;
 80483e5:    55                       push   %ebp
 80483e6:    89 e5                    mov    %esp,%ebp

&#23558;&#26632;&#39030;&#25351;&#38024;&#22320;&#22336;&#20943;8byte(&#20004;&#20010;<span class="org-type">int</span>&#30340;&#38271;&#24230;),&#22312;&#26632;&#19978;&#24320;&#36767;&#20004;&#20010;<span class="org-type">int</span>&#23383;&#33410;&#30340;&#38271;&#24230;
 80483e8:    83 ec 08                 sub    $0x8,%esp
    foo(2, 3);

 <span class="org-type">&#20381;&#27425;&#23558;</span> <span class="org-variable-name">&#21442;&#25968;3</span> &#12289;2&#20837; &#26632; ,0x4(%esp)&#34920;&#31034;&#30340;&#22320;&#22336;&#26159; :4+ esp&#20013;&#25152;&#25351;&#22320;&#22336;
 80483eb:    c7 44 24 04 03 00 00     movl   $0x3,0x4(%esp)
 80483f2:    00
 80483f3:    c7 04 24 02 00 00 00     movl   $0x2,(%esp)
&#36339;&#21040;foo()&#20989;&#25968;&#30340;&#39318;&#22320;&#22336;&#36827;&#34892;&#25191;&#34892;
 80483fa:    e8 cc ff ff ff           call   80483cb &lt;foo&gt;
    <span class="org-keyword">return</span> 0;
&#36825;&#34892;move&#19981;&#29702;&#35299;
 80483ff:    b8 00 00 00 00           mov    $0x0,%eax
}
</pre>

foo函数的调用<br/>
</p>
<p><br/>
<pre class="src src-c"><span class="org-type">int</span> <span class="org-function-name">foo</span>(<span class="org-type">int</span> <span class="org-variable-name">a</span>, <span class="org-type">int</span> <span class="org-variable-name">b</span>)
{
&#39318;&#20808;&#32463;&#36807;main&#30340;&#35843;&#29992;&#65292;&#26632;&#19978;&#20803;&#32032;&#20381;&#27425;&#26159; 3,2,
&#32463;&#36807;&#27492;&#27493;push   %ebp ,&#26632;&#21464;&#25104;&#20102;&#65292;3 ,2 ,%ebp ,&#27880;&#24847;&#65292;&#27492;&#26102;&#65292;%ebp&#20013;&#30340;&#22320;&#22336;&#26159;main &#20989;&#25968;
&#30340;&#39318;&#22320;&#22336;,<span class="org-type">&#21363;&#23558;main</span> <span class="org-variable-name">&#20989;&#25968;&#30340;&#39318;&#22320;&#22336;&#21387;&#26632;</span>&#65292;&#65288;&#20445;&#23384;main&#30340;&#39318;&#22320;&#22336;&#65292;&#20197;&#20415;&#35843;&#29992;&#23436;foo&#20989;&#25968;&#65292;&#32487;
&#32493;&#25191;&#34892;main&#20989;&#25968;&#26102;&#24674;&#22797;ebp&#30340;&#20540;&#65289;(push&#25805;&#20316;&#22312;&#20837;&#26632;&#26102;&#65292;&#20250;&#33258;&#21160;&#23558;esp&#30340;&#20540;&#20943;4)
80483cb:    55                       push   %ebp
%esp &#22987;&#32456;&#25351;&#21521;&#26632;&#39030;&#20803;&#32032;
&#32463;mov    %esp,%ebp &#65292;&#27492;&#26102;ebp&#25152;&#25351;&#30340;&#22320;&#22336;&#36319;&#24403;&#19979; esp&#25152;&#25351;&#30340;&#26632;&#39030;&#22320;&#22336;&#30456;&#21516;
&#21363;&#23558;ebp&#25351;&#21521;&#26032;&#30340; foo&#20989;&#25968;&#26632;&#24103;&#30340;&#39318;&#22320;&#22336;
 80483cc:    89 e5                    mov    %esp,%ebp
&#20934;&#22791;&#21521;&#26632;&#19978;&#21387;&#20837;&#20004;&#20010;&#20803;&#32032;&#65292;
&#27492;&#26102;&#26632;&#19978;&#20803;&#32032;&#20026;: 3,2,main_ebp,&#31354;,<span class="org-type">&#31354;</span>
<span class="org-variable-name">&#27492;&#26102;ebp&#19982;esp&#20043;&#38388;&#26377;&#20004;&#20010;&#31354;&#20803;&#32032;</span>
 80483ce:    83 ec 08                 sub    $0x8,%esp
    <span class="org-keyword">return</span> bar(a, b);
<span class="org-type">&#32463;&#27492;&#25805;&#20316;</span> <span class="org-variable-name">&#26632;&#21464;&#25104;</span> 3,2,main_ebp,3,&#31354;
0xc+%ebp&#30340;&#22320;&#22336;&#20013;&#30340;&#20869;&#23481;&#26159;3,
 80483d1:    8b 45 0c                 mov    0xc(%ebp),%eax
 80483d4:    89 44 24 04              mov    %eax,0x4(%esp)

<span class="org-type">&#32463;&#27492;&#25805;&#20316;</span> <span class="org-variable-name">&#26632;&#21464;&#25104;</span> 3,2,main_ebp,3,2
 80483d8:    8b 45 08                 mov    0x8(%ebp),%eax
 80483db:    89 04 24                 mov    %eax,(%esp)

&#36339;&#21040;80483b4&#22788;&#25191;&#34892;bar()&#20989;&#25968;
 80483de:    e8 d1 ff ff ff           call   80483b4 &lt;bar&gt;
}
</pre>

P.S.关于地址的表示方式 0xc(%ebp)内容见 <a href="x86.html">寻址方式</a><br/>
</p>
<p><br/>
<pre class="src src-c">080483b4 &lt;bar&gt;:
<span class="org-type">int</span> bar(<span class="org-type">int</span> <span class="org-variable-name">c</span>, <span class="org-type">int</span> <span class="org-variable-name">d</span>)
{
 80483b4:    55                       push   %ebp
 80483b5:    89 e5                    mov    %esp,%ebp
<span class="org-preprocessor"># &#36825;&#20010;sub</span> &#21629;&#20196;&#65292;&#25105;&#19981;&#22826;&#26126;&#30333; &#65292;&#21442;&#25968;&#20026;&#20160;&#20040;&#26159;10,&#32780;&#19981;&#26159;0xc,&#25110;&#32773;8
<span class="org-preprocessor">#&#22914;&#26524;&#31639;&#19978;&#23616;&#37096;&#21464;&#37327;e</span> &#30340;&#31350;&#31455;&#24212;&#35813;&#26159;8+4,&#22914;&#26524;&#19981;&#31639;&#65292;&#21017;&#20026;8,&#20026;&#20160;&#20040;&#26159;10&#21602;
 80483b7:    83 ec 10                 sub    $0x10,%esp
    <span class="org-type">int</span> e = c + d;
<span class="org-preprocessor"># &#36825;&#26159;&#23558;foo&#20989;&#25968;&#20013;&#26368;&#21518;&#21387;&#26632;&#30340;&#20004;&#20010;&#21442;&#25968;&#21462;&#20986;&#25918;&#21040;eax</span> edx&#20013;&#65292;
 80483ba:    8b 45 0c                 mov    0xc(%ebp),%eax
 80483bd:    8b 55 08                 mov    0x8(%ebp),%edx
<span class="org-preprocessor">#&#36825;&#20010;&#21033;&#29992;</span> &#23547;&#22336;(%dex,%eax,1)= %edx+%eax+1 ,&#21363;&#20570;&#21152;&#27861;&#36816;&#31639;&#65292;
<span class="org-preprocessor">#&#38590;&#36947;&#27809;&#26377;add&#25351;&#20196;</span>&#65311; lea&#26159;&#23558;&#36816;&#31639;&#21518;&#30340;&#32467;&#26524;&#23384;&#21040;%eax&#20013;
 80483c0:    8d 04 02                 lea    (%edx,%eax,1),%eax
<span class="org-preprocessor">#&#23558;&#36816;&#31639;&#32467;&#26524;&#23384;&#21040;&#23616;&#37096;&#21464;&#37327;e&#20013;</span>
 80483c3:    89 45 fc                 mov    %eax,-0x4(%ebp)
    <span class="org-keyword">return</span> e;
 &#25226;e&#30340;&#20540;&#25918;&#21040;%eax&#20013;&#65292;&#36820;&#21152;
 80483c6:    8b 45 fc                 mov    -0x4(%ebp),%eax
}
 80483c9:    c9                       leave
 80483ca:    c3                       ret
</pre>

bar函数有一个int型的返回值，这个返回值是通过eax寄存器传递的，所以首先把e的值读<br/>
到eax寄存器中。然后执行leave指令，这个指令是函数开头的push %ebp和mov %esp,%ebp<br/>
的逆操作：<br/>
最后是ret指令，它是call指令的逆操作：<br/>
</p>
<p><br/>
</p><ul>
<li>参数压栈传递，并且是从右向左依次压栈。<br/>
</li>
<li>ebp总是指向当前栈帧的栈底。<br/>
</li>
<li>返回值通过eax寄存器传递<br/>
</li>
</ul>


<p><br/>
<div id='my-src'>
<div id='org-src'><a href='../src/c/c_assemble.org'>src</a></div>
<div id='htmlized-src'><a href='../htmlized-src/c/c_assemble.org.html'>htmlized-src</a></div>
</div>
<div id='tags'><span id='tags-title'>Tags:</span><br />
    <a href="../tags/@SVN.html">@SVN</a><br/>
    <a href="../tags/@perl.html">@perl</a><br/>
    <a href="../tags/@Java.html">@Java</a><br/>
    <a href="../tags/@Mysql.html">@Mysql</a><br/>
    <a href="../tags/@Erlang.html">@Erlang</a><br/>
    <a href="../tags/@SQL.html">@SQL</a><br/>
    <a href="../tags/@DB.html">@DB</a><br/>
    <a href="../tags/@Oracle.html">@Oracle</a><br/>
    <a href="../tags/@Ediff.html">@Ediff</a><br/>
    <a href="../tags/@Git.html">@Git</a><br/>
    <a href="../tags/@Cedet.html">@Cedet</a><br/>
    <a href="../tags/@C-C++.html">@C-C++</a><br/>
    <a href="../tags/@Daily.html">@Daily</a><br/>
    <a href="../tags/@Eclipse.html">@Eclipse</a><br/>
    <a href="../tags/@AutoHotKey.html">@AutoHotKey</a><br/>
    <a href="../tags/@Windows.html">@Windows</a><br/>
    <a href="../tags/@Linux.html">@Linux</a><br/>
    <a href="../tags/@C.html">@C</a><br/>
    <a href="../tags/@Emacs.html">@Emacs</a><br/>
</p>
<p><br/>
</div>
</p></div>
</div>
</div>

<div id="postamble">
<p class="date">Date: 2012-04-29 日</p>
<p class="author">Author: 纪秀峰</p>
<p class="creator">Org version 7.8.03 with Emacs version 24</p>


</div>
<p><br/><br/>
<!-- hhmts start --> <!-- hhmts end --></p>

</body>
</html>
